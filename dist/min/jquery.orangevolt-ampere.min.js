/*!
 * jQuery Orangevolt Ampere
 *
 * version : 0.2.0
 * created : 2013-07-22
 * source  : https://github.com/lgersman/jquery.orangevolt-ampere
 *
 * author  : Lars Gersmann (lars.gersmann@gmail.com)
 * homepage: http://www.orangevolt.com
 *
 * Copyright (c) 2013 Lars Gersmann; Licensed MIT, GPL
 */jQuery.ov&&jQuery.ov.compat||function(e){e.ov=e.ov||{},e.ov.compat={},Object.keys&&-1!=(""+Object.keys).indexOf("[native code]")||(Object.keys=function(t){var n=[];if(this){if(!e.isArray(t)){var i=[];for(var r in t)Object.hasOwnProperty.call(t,r)&&(i[i.length]=r);return i}for(var a=0;t.length>a;a++)n.push(a)}return n})}(jQuery),jQuery.ov&&jQuery.ov.json||function(e){function t(e){return r.lastIndex=0,r.test(e)?'"'+e.replace(r,function(e){var t=a[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function n(t){return t=t.jquery?t:e(t),t.length>0?t.map(function(){var e=this.getAttribute?this.getAttribute("id")||this.getAttribute("name"):"";return this.tagName+(e?"#"+e:"")}).get().join(", "):t.jquery?t.selector:""+t}var i=["abstract","boolean","break","byte","case","catch","char","class","const","continue","debugger","default","delete","do","double","else","enum","export","extends","false","final","finally","float","for","function","goto","if","implements","import","in","instanceof","int","interface","long","native","new","null","package","private","protected","public","return","short","static","super","switch","synchronized","this","throw","throws","transient","true","try","typeof","var","void","volatile","while","with"],r=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,a={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};if(jQuery.ov.json={stringify:function(r,a){if(!e.isArray(this))return jQuery.ov.json.stringify.call([],r,a);a=a||{},a.indent=a.indent||"  ",a._currindent=a._currindent||"",a._linebreak=a._linebreak||"\r\n",a.alignPropertyNames=a.alignPropertyNames===!1?!1:!0,a.optimizePropertyNames=a.optimizePropertyNames===!1?!1:!0;var o=typeof r;if(r===window)return"<Window>window";if(r===window.document)return"<Document>window.document";if("object"==o&&null!==r&&void 0!==r&&r.nodeType)return"<HTMLElement>"+n(r);if("object"!=o||null===r)return"string"==o&&(r=t(r)),r+"";var s,u,c,l=[],p=e.isArray(r),m=Object.keys(r),d=0;if(a.alignPropertyNames)for(s=0;m.length>s;s++)d=Math.max(d,m[s].length);for(s=0;m.length>s;s++)if(u=m[s],c=r[u],o=typeof c,!("function"==o&&a.skipFunctions||null===c&&a.skipNull||"undefined"==o&&a.skipUndefined)){if(null!==c)if("object"!=o||-1==e.inArray(c,this)){"object"!=o||this.push(c);var f=e.extend({},a);f._currindent=a._currindent+a.indent,c=jQuery.ov.json.stringify.call(this,c,f)}else c="(circular ref ... "+c+")";u=a.optimizePropertyNames&&-1==e.inArray((""+u).toLowerCase(),i)?u:'"'+u+'"';var g="  ";if(a.alignPropertyNames)for(var h=d-u.length;h-->0;)g=g.concat(" ");l.push((p?"":u+g+": ")+(c+""))}return l=m.length?a._linebreak+a._currindent+a.indent+l.join(","+a._linebreak+a._currindent+a.indent)+a._linebreak+(a._currindent.length>0?a._currindent.substring(0,a._currindent.length-0):a._currindent):"",(p?"[":"{")+l+(p?"]":"}")}},e.extend(e.ov.json.stringify,{COMPACT:{indent:"",linebreak:"",skipFunctions:!0,alignPropertyNames:!1,optimizePropertyNames:!0},FORMATTED:{indent:"  ",linebreak:"\r\n",skipFunctions:!0,alignPropertyNames:!0,optimizePropertyNames:!0}}),!window.JSON){var o={indent:"",linebreak:"",skipFunctions:!0,skipUndefined:!0,alignPropertyNames:!1,optimizePropertyNames:!1};window.JSON={stringify:function(t){return e.ov.json.stringify(t,o)}}}}(jQuery),jQuery.ov&&jQuery.ov.namespace||function(e){function t(){for(var t="",n=0;arguments.length>n;n++){var i=e.isFunction(arguments[n])?arguments[n].name||"function() {...}":arguments[n];i&&i.jquery&&(t+="<jQuery>",i=i.get(),i=1==i.length?i[0]:i),t+=i&&i.nodeType?e.ov.json.stringify(i,e.ov.json.stringify.COMPACT):null===i||void 0===i||"object"==typeof i?e.ov.json.stringify(i,e.ov.json.stringify.COMPACT):i}return t}function n(t){var n={},i=e.noop;return window.console&&(i=window.console[t]||window.console.log||e.noop),n[i]||(n[i]=i===e.noop?e.noop:e.proxy(i,window.console))}e.ov=e.ov||{},e.ov.namespace=function(t){return t||(t=""),e.ov.namespace[t]?e.ov.namespace[t]:this instanceof e.ov.namespace?(this._namespace=t,e.ov.namespace[t]=this):new e.ov.namespace(t)},e.ov.namespace.filter=function(){},e.ov.namespace.prototype={debug:function(){var i=e.ov.namespace.filter("debug",this._namespace);if(void 0===i||i){var r=e.makeArray(arguments);return r.unshift("#DEBUG: "),r.unshift(this._namespace),n("debug").call(this,t.apply(this,r)),this}},error:function(){var i=e.ov.namespace.filter("error",this._namespace);if(void 0===i||i){var r=e.makeArray(arguments);return r.unshift("#ERROR: "),r.unshift(this._namespace),n("error").call(this,t.apply(this,r)),this}},warn:function(){var i=e.ov.namespace.filter("warn",this._namespace);if(void 0===i||i){var r=e.makeArray(arguments);return r.unshift("#WARN: "),r.unshift(this._namespace),n("warn").call(this,t.apply(this,r)),this}},assert:function(n){var i=e.makeArray(arguments);if(i.shift(),!n){i.length||i.push("assertion failed"),i.unshift("#ASSERT: "),i.unshift(this._namespace);var r=t.apply(this,i);throw Error(r)}return this},raise:function(){var n=e.makeArray(arguments);throw n.unshift("#ERROR: "),n.unshift(this._namespace),Error(t.apply(this,n))},attempt:function(n){var i=e.makeArray(arguments);i.shift(),this.assert(e.isFunction(n),"first argument expected to be a function");var r;try{r=n.call(this)}catch(a){i.length||i.push("problem executing function "+n.name),i.push(" : "+(a.message||a)),i.unshift("#ATTEMPT: "),i.unshift(this._namespace);var o=t.apply(this,i);throw Error(o)}return this}}}(jQuery),window.ov&&window.ov.entity||function(e){function t(t,n){switch(e.type(n)){case"function":return function(e){return e=arguments.length?e:this,n.call(this,e)};case"object":return function(t){t=arguments.length?t:this;var i=window.ov.entity.find(n.values,"object"==e.type(t)?t[n.id||"id"]:t);return i};case"array":return function(e){e=arguments.length?e:this;var i=window.ov.entity.find(n,e[t]);return i};default:return function(e){return e=arguments.length?e:this,e[t]}}}function Projection(e){if(!(this instanceof Projection))return new Projection(e);for(var n=Object.keys(e||{}),i=0;n.length>i;i++){var r=n[i],a=e[r];this["get"+window.ov.ampere.util.ucwords(r)]=t(r,a)}this.options=function(){return e}}function Entity(t,n){return this instanceof Entity?(e.ov.namespace("window.ov.entity").assert("array"==e.type(t),"first argument expected to be an array"),this.get=function(){return t},this.projection=function(){var t=n instanceof Projection?n:window.ov.entity.projection(n);return function(n){if(1==arguments.length){if(arguments[0]instanceof Projection)return arguments[0];var i=function(){return e.extend(this,e.isPlainObject(n)?n:this.get_(n)),this.get=function(){return n},this};return i.prototype=t,new i}return t}}(),this):new Entity(t,n)}function n(t,n){switch(e.type(t)){case"function":return t;case"object":var i=Object.keys(t);return function(e){for(var n=0;i.length>n;n++){var r=i[n];if(t[r]!=e[r])return!1}return!0};case"regexp":return n=n||"id",function(i){var r=i[n];if(!e.isArray(r))return t.test(r);for(var a=0;r.length>a;a++)if(t.test(r[a]))return!0};default:return n=n||"id",function(i){var r=e.isPlainObject(i)?i[n]:i;return e.isArray(r)?-1!=e.inArray(t,r):r===t}}}window.ov=window.ov||{},e.ov.namespace("window.ov.entity"),Projection.atomic=function(e){return Projection({_:e})},Projection.prototype.get=function(t,n){var i="get"+window.ov.ampere.util.ucwords(n||"_");return e.isFunction(this[i])?this[i](t):t[n]},Projection.prototype.has=function(t,n){var i="get"+window.ov.ampere.util.ucwords(n);return e.isFunction(this[i])},Projection.prototype.match=function(t,n){var i=[];if("string"==typeof n&&(n=e.trim(n),!n.length))return i.concat(t),i;n="string"==typeof n?RegExp(window.ov.ampere.util.regexp_quote(n)):n,e.ov.namespace("window.ov.entity.projection::match()").assert("regexp"==e.type(n),"argument expected to be an regexp or string");for(var r,a=0;t.length>a;a++){r||(r=e.isPlainObject(t[a])?Object.keys(t[a]):"_");for(var o=t[a],s=0;r.length>s;s++){var u=this.get(o,r[s]);switch(e.type(u)){case"function":break;case"object":for(var c=Object.keys(u),l=0;c.length>l;l++)if(n.test(u[c[l]])){i.push(o);break}break;case"array":for(var p=0;u.length>p;p++)if(n.test(u[p])){i.push(o);break}break;default:if(n.test(u)){i.push(o);break}}}}return i},Projection.prototype.all=function(t,n,i){var r=[];n=arguments.length>1&&n||"_";var a=this.options()[n];e.ov.namespace("window.ov.entity.projection::all()").assert(e.isPlainObject(a)&&e.isArray(a.values),"only mapped array supported right now");for(var o=0;a.values.length>o;o++){var s,u=a.values[o],c=u[a.id];-1!=(s=e.inArray(c,t))?!i&&r.splice(Math.min(s,r.length),0,u):i&&r.splice(Math.min(o,r.length),0,u)}return r},window.ov.entity=Entity,window.ov.entity.prototype.find=function(e,t){return window.ov.entity.find(this.get(),e,t)},window.ov.entity.prototype.filter=function(e,t){return window.ov.entity.filter(this.get(),e,t)},window.ov.entity.prototype.next=function(e){return window.ov.entity.next(this.get(),e)},window.ov.entity.prototype.prev=function(e){return window.ov.entity.prev(this.get(),e)},window.ov.entity.prototype.first=function(){return window.ov.entity.first(this.get())},window.ov.entity.prototype.last=function(){return window.ov.entity.last(this.get())},window.ov.entity.prototype.where=function(e){return window.ov.entity.where(this.get(),e)},window.ov.entity.prototype.select=function(e){return window.ov.entity.select(this.get(),e)},window.ov.entity.prototype.last=function(){return window.ov.entity.last(this.get())},window.ov.entity.prototype.match=function(e){return this.projection().match(this.get(),e)},window.ov.entity.prototype.all=function(){return this.projection().all.apply(this.projection(),arguments)},window.ov.entity.find=function(t,i,r){var a=n(i,r);if(e.isArray(t))for(var o=0;t.length>o;o++){var s=t[o];if(a.call(t,s,o,r))return s}},window.ov.entity.filter=function(e,t,i){for(var r=[],a=n(t,i),o=0;e.length>o;o++){var s=e[o];a.call(e,s,o,i)&&r.push(s)}return r},window.ov.entity.next=function(t,n){var i=e.inArray(n,t);return t.length-1>i?t[i+1]:void 0},window.ov.entity.prev=function(t,n){var i=e.inArray(n,t);return i>0?t[i-1]:void 0},window.ov.entity.first=function(e){return e.length&&e[0]||void 0},window.ov.entity.last=function(e){return e.length&&e[e.length-1]||void 0},window.ov.entity.projection=Projection,window.ov.entity.lambda=function(t){var n=t.match(/\((.*)\)\s*=>\s*(.*)/),i=[],r=t;n&&n.length&&(n.shift(),r=n.pop(),i=e.trim(n.pop().replace(/,/g," ")).split(/\s+/)),n=(!/\s*return\s+/.test(r)&&"return "||"")+r+";",i.push(n);try{return Function.apply({},i)}catch(a){e.ov.namespace("window.ov.entity.lambda()").raise("could not transform lamda expression(='"+t+"') into a function : ",i)}},window.ov.entity.where=function(t,n){n=e.isFunction(n)&&n||window.ov.entity.lambda(n);for(var i=[],r=[0,0,i],a=arguments.length-1;a>1;a--)r.push(arguments[a]);for(a=0;t.length>a;a++)r[0]=t[a],r[1]=a,n.apply(t[a],r)&&i.push(t[a]);return i},window.ov.entity.select=function(t,n){n=e.isFunction(n)&&n||window.ov.entity.lambda(n);for(var i=[],r=[0,0,i],a=arguments.length-1;a>1;a--)r.push(arguments[a]);for(t=e.isArray(t)&&t||[t],a=0;t.length>a;a++)r[0]=t[a],r[1]=a,i.push(n.apply(t[a],r));return i},window.ov.entity.sort=function(t,n,i){function r(e){return e}function a(e,t){for(var i=0;n.length>i;i++){var r=n[i](e,t);if(0!==r)return r}return 0}function o(e,t){return t?function(t,n){return e(n,t)}:e}function s(e,t){var n=typeof e,i=typeof t;return n==i?("string"==n&&(e=e.toLowerCase()),"string"==n&&(t=t.toLowerCase()),e===t?0:t>e?-1:1):i>n?-1:1}return t instanceof Array?n?(n=e.isArray(n)?n:[n],n=e.map(n,function(e){var t=!1,n=e||r;return"string"==typeof e&&(("+"==e.charAt(0)||"-"==e.charAt(0))&&(t="-"==e.charAt(0),e=e.substring(1)),n=function(t){return t[e]}),o(function(e,t){return s(n(e),n(t))},t)}),t.sort(o(a,i)),[].concat(t)):t:t}}(jQuery),jQuery&&jQuery.fn.upload||function(e){if(e.support.ajaxProgress="onprogress"in e.ajaxSettings.xhr()){var t=e.ajax;e.ajax=function(n,i){"object"==typeof n&&(i=n,n=i.url),i=i||{};var r,a=e.Deferred(),o=i.xhr||e.ajaxSettings.xhr;i.xhr=function(){var t=this,n=o.call(e.ajaxSettings);if(n){var i=function(n){return function(i){t.global&&e.event.trigger("ajaxProgress",[i,n,r]),e.isFunction(t.progress)&&t.progress(r,i,n),a.notifyWith(r,[i,n])}};n.upload.addEventListener("progress",i(!0),!1),n.addEventListener("progress",i(!1),!1)}return n},r=t.call(this,n,i);for(var s in a.promise())r[s](a[s]);return r.progress=a.progress,r},e.upload=function(t,n,i,r){return jQuery.isFunction(n)&&(r=r||i,i=n,n=void 0),e.ajax({processData:!1,contentType:!1,type:"POST",url:t,data:n,success:i,dataType:r})}}}(jQuery),jQuery&&jQuery.fn.upload||function(e){e.fn.checkValidity=function(){var t=this.length&&this[0];return t&&e.isFunction(t.checkValidity)?t.checkValidity():!0},e.fn.validity=function(){var e=this.length&&this[0];return e&&e.validity||{customError:"",patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,typeMismatch:!1,valid:!0,valueMissing:!1}},e.fn.validationMessage=function(){var e=this.length&&this[0];return e&&"string"==typeof e.validationMessage?e.validationMessage:""},e.fn.setCustomValidity=function(t){var n=this.length&&this[0];return n&&e.isFunction(n.setCustomValidity)&&(n.setCustomValidity(""),n.checkValidity()&&(e.isFunction(t)&&(t=t.call(n,n)),t&&n.setCustomValidity(t))),this},e(document).on("input change",".html5validation-title",function(t){e(t.target).attr("title",t.target.validationMessage)})}(jQuery),window.ov&&window.ov.ampere||function(e){function t(e){var t=[];for(var n in e)t.push(e[n]);return t}function Options(t){var n=t||{};return function(){if(2==arguments.length)return n[arguments[0]]=arguments[1],this;if(1==arguments.length){var t=arguments[0];return e.isPlainObject(t)?(angular.extend(n,t),this):n[t]}return n}}function History(t,n){if(!(this instanceof History))return new History(t,n);n=n||{};var i=n["ampere.history.limit"];i=void 0===i||null===i?0:i;var r=this;this.canUndo=function(){return r.position},this.canRedo=function(){return r.stack.length-r.position},this.canReset=function(){return r.stack.length};var a;this.retry=function(){},this.canRetry=function(){return a};var o;return i&&n["ampere.history.html5"]&&window.history&&window.history.pushState&&(o=parseInt(e.now()+"00",10),window.history.replaceState(o,document.title,window.location.pathname+window.location.hash),e(window).on("popstate",function(e){if(e.originalEvent.state)for(var t=0;r.stack.length>t;t++){var n=r.stack[t];if(n.hash==e.originalEvent.state)return r.position>t?r.undo(e):r.redo(e),void 0}})),this.redo=function(){var n;if(arguments.length){if(!(arguments[0]instanceof jQuery.Event)){var a,s=arguments[0],u=(s.ui,t.current().view);n=function(i){var r=t._transit(s.command,s.source,s.target,s.view,s.ui,i);return a||e.isFunction(r)&&(a=function(i){var a=t._transit(r,s.target,s.source,u,s.ui,i);return n.promise=e.when(a).promise,e.isFunction(a)?n:void 0},a.target=s.source,a.view=u),a&&(a.promise=e.when(r).promise),e.isFunction(r)?a:void 0},n.target=s.target,n.view=s.view}}else!o||!r.canRedo()||arguments[0]instanceof jQuery.Event||window.history.forward();var c=e.Deferred(),l=n||r.canRedo()&&r.stack[r.position],p=e.isFunction(l)&&l(c);return e.when(p).done(function(){i>0&&(p?(p.hash=window.history.state,n?(r.stack.splice(r.position),r.stack.push(p),r.position=r.stack.length,o&&c.done(function(){o++;var n=window.location.pathname,i=t.current().state.options("ampere.history.html5.route");i&&(e.isFunction(i)&&(i=i.call(t.current().state),void 0===i&&null===i&&(i="")),n+="#"+i),window.history.pushState(o,document.title,n)})):r.canRedo()&&(o&&c.done(function(){p.hash=l.hash-1}),r.stack[r.position++]=p)):l&&(r.stack.splice(0,r.position),r.position=r.stack.length),r.stack.length>i&&(r.stack.shift(),r.position=r.stack.length))}).always(c.resolve),l},this.redo.target=function(){return r.canRedo()&&r.stack[r.position].target},this.undo=function(){if(r.canUndo()){!o||arguments[0]instanceof jQuery.Event||window.history.back();var t=r.stack[--r.position],n=e.Deferred(),i=t(n);e.when(i).done(function(){i?(o&&n.done(function(){i.hash=t.hash+1}),r.stack[r.position]=i):r.stack.splice(r.position)}).always(n.resolve)}return this},this.undo.target=function(){return r.canUndo()&&r.stack[r.position-1].target},this.reset=function(){return r.stack=[],r.position=0,r},this.reset.target=function(){return t.current().state},this.rewind=function(){for(;this.canUndo();)this.undo(!1);return this},this.playback=function(){for(;this.canRedo();)this.redo(!1);return this},this.reset(),this}function Transition(t,n,i,r){return this instanceof Transition?(this.options=Options(),this.state=function(){return t},this.name=function(){return i},this.fullName=function(){return(t||r).fullName()+".transitions."+i},this.target=function(){return e.isFunction(n)?n.call(this):n},this.action=function(){function t(){return t}var n=t;return function(){return arguments.length?(e.ov.namespace(this.fullName()+".action()").assert(1==arguments.length&&e.isFunction(arguments[0]),"function expected as argument"),n=arguments[0],this):n}}(),this.enabled=function(){var n=function(){return!0};return function(){if(arguments.length){var i=arguments[0];if(!e.isFunction(i)){var a=arguments[0];i=function(){return a}}return e.ov.namespace(this.fullName()+".enabled()").assert(1==arguments.length,"single argument expected"),n=i,this}var o=(t&&t.module()||r).trigger("ampere.transition-enabled",[this]);if(void 0===o.result||o.result){var s=n.call(this,this);return s}}}(),this.active=function(){var t=e.noop;return function(){if(arguments.length){var n=arguments[0];if(!e.isFunction(n)){var i=arguments[0];n=function(){return i}}return e.ov.namespace(this.fullName()+".active()").assert(1==arguments.length,"single argument expected"),t=n,this}var r=t.call(this,this);return r}}(),void 0):new Transition(t,n,i,r)}function View(e,t,n){return this instanceof View?(this.options=Options(),this.state=function(){return e},this.name=function(){return t},this.fullName=function(){return e.fullName()+".views."+t},this.template=function(){return n},void 0):new View(e,t,n)}function State(n,i){return this instanceof State?(this.options=Options(),this.module=function(){return n},this.name=function(){return i},this.fullName=function(){return n.fullName()+".states."+i},this.transitions={},this.views={},this._super=function(){this.transition=function(){var i,r,a=e.ov.namespace(this.fullName()+".transition()");return arguments.length?1==arguments.length?"string"==typeof arguments[0]?(i=this,r=arguments[0]):arguments[0]instanceof State?(i=arguments[0],r=i.name()):e.isFunction(arguments[0])?(i=arguments[0],r=window.ov.ampere.util.functionName(i)?window.ov.ampere.util.functionName(i):"main"):a.raise("dont know how to handle arguments ",arguments):2==arguments.length?(r=arguments[0],i=arguments[1]):a.raise("too much arguments ",arguments):(i=this,r=i.name()),a.assert(e.isFunction(i)||i instanceof State,"argument targetState expected to be a state or function returning a state, but it is ",i).assert(e.isFunction(i)||-1!=e.inArray(i,t(n.states)),"argument targetState expected to be a state of same module").assert(!this.transitions[r],'transition "',r,'" already exists'),this.transitions[r]=Transition(this,i,r),this.transitions[r]},this.view=function(){var t=e.ov.namespace(this.fullName()+".view()").assert(arguments.length,"no arguments given"),n=arguments.length>1?arguments[0]:void 0,i=arguments[arguments.length>1?1:0];return n||(e.isFunction(i)?n=window.ov.ampere.util.functionName(i):(i||{}).jquery&&(n=i.selector),n=n||"main"),t.assert(!this.views[n],'view "'+n+'" already exists'),t.assert(i||""===i||null==i,'view "'+n+'" : template argument missing'),this.views[n]=new View(this,n,i)},this.view.load=e.proxy(function(t,n){return 1==arguments.length?this.view("main",e.get(arguments[0])):this.view(t||"main",e.get(n))},this)},void 0):new State(n,i)}function Module(n,i){return this instanceof Module?(this.ampere=function(){return n},this.name=function(){return i},this.fullName=function(){return"ampere.modules."+i},this._super=function(){var n=this;this.options=Options();var i={state:void 0,view:void 0,reset:void 0};this.current=function(r,a){if(2==arguments.length||3==arguments.length){e.ov.namespace(n.fullName()+".current()").assert(-1!=e.inArray(r,t(n.states)),"argument expected to be state of same module"),e.ov.namespace(n.fullName()+".current()").assert(!a||-1!=e.inArray(a,t(r.views)),'argument expected to be view of state "',r.name(),'"'),i.state=r,i.view=a,i.reset={};for(var o=Object.keys(r),s=0;o.length>s;s++)"promise"!=o[s]&&("object"!=typeof i.state[o[s]]||e.isPlainObject(i.state[o[s]]))&&(e.ov.namespace(n.fullName()+".current.reset()").debug("backup property ",o[s]),i.reset[o[s]]=angular.copy(i.state[o[s]]))}else{if(!arguments.length)return i;e.ov.namespace(n.fullName()+".current()").raise("2 or no arguments expected but ",arguments," given")}},this.current.reset=function(){var t,r=Object.keys(i.state);for(t=0;r.length>t;t++)"promise"!=r[t]&&(e.ov.namespace(n.fullName()+".current.reset()").debug("delete property ",r[t]),delete i.state[r[t]]);for(r=Object.keys(i.reset),t=0;r.length>t;t++)("object"!=typeof i.reset[r[t]]||e.isPlainObject(i.reset[r[t]]))&&(e.ov.namespace(n.fullName()+".current.reset()").debug("set property ",r[t],"=",i.reset[r[t]]),i.state[r[t]]=angular.copy(i.reset[r[t]]))},this.states={},this.state=function(){var t,n,i,r,a,o,s=e.ov.namespace(this.fullName()+".state()").assert(arguments.length,"no arguments given"),u=[];if(1==arguments.length&&e.isArray(arguments[0])){var c=arguments[0];for(n=0;c.length>n;n++)s.assert(e.isFunction(c[n])||"string"==typeof c[n],'array item type "function" or "string" expected'),this.state(e.isFunction(c[n])?window.ov.ampere.util.functionName(c[n]):c[n]);for(n=0;c.length>n;n++){i=this.states[window.ov.ampere.util.functionName(c[n])],e.isFunction(c[n])&&c[n].call(i,i),r=Object.keys(i);for(a in r)"promise"!=r[a]&&(o=i[r[a]],o instanceof Component&&o.init(i),e.isFunction(o.promise)&&u.push(o.promise))}return this}if(1==arguments.length&&e.isPlainObject(arguments[0])){var l=arguments[0];for(t in l)this.state(t);for(t in l){s.assert(e.isFunction(l[t]),'initializer function expected as value of state "',t+'"'),i=this.states[t],u.push(l[t].call(i,i)),r=Object.keys(i);for(a in r)"promise"!=r[a]&&(o=i[r[a]],o instanceof Component&&o.init(i),e.isFunction(o.promise)&&u.push(o.promise))}return this.promise=e.when.apply(e.when,u).promise,this}var p=e.makeArray(arguments);t=p.shift();var m=e.isFunction(t)?t:p.shift()||e.noop;return t="string"==typeof t?t:window.ov.ampere.util.functionName(t),s.assert(!this.states[t],'state "'+t+'" already exists'),i=function(){this._super(),e.isFunction(this.promise)&&u.push(this.promise()),u.push(m.call(this,this)),r=Object.keys(this);for(var t in r)"promise"!=r[t]&&(o=this[r[t]],o instanceof Component&&o.init(this),e.isFunction(o.promise)&&u.push(o.promise));this.promise=e.when.apply(e.when,u).promise},i.prototype=State(this,t),this.states[t]=new i,this.states[t]},this.transitions={},this.transition=function(){var i,r,a=e.ov.namespace(this.fullName()+".transition()").assert(arguments.length,"no arguments given");return arguments.length&&(1==arguments.length?arguments[0]instanceof State?(i=arguments[0],r=i.name()):e.isFunction(arguments[0])?(i=arguments[0],r=""!==window.ov.ampere.util.functionName(i)?window.ov.ampere.util.functionName(i):"main"):"string"==typeof arguments[0]?(i=this.states[arguments[0]],r=arguments[0]):a.raise("dont know how to handle arguments ",arguments):2==arguments.length?(r=arguments[0],i=arguments[1]):a.raise("dont know how to handle arguments ",arguments)),a.assert(e.isFunction(i)||i instanceof State,"argument targetState expected to be a state or function returning a state, but it is ",i).assert(e.isFunction(i)||-1!=e.inArray(i,t(n.states)),"argument targetState expected to be a state of same module").assert(!this.transitions[r],'transition "',r,'" already exists'),this.transitions[r]=Transition(null,i,r,this),this.transitions[r]},this._transit=function(t,i,r,a,o,s){function u(){if(1==arguments.length&&arguments[0]==d)o&&o.unblock();else if(c.rejectWith(n,arguments),o){var t=function(){n.history().redo(l)};if(1==arguments.length&&"string"==typeof arguments[0])o.render("Error",arguments[0],t);else{if(1==arguments.length&&arguments[0]instanceof Error)throw o.render("Error",arguments[0],t),arguments[0];3==arguments.length&&e.isFunction(arguments[0].statusCode)?o.render("Error","Ajax request failed ("+arguments[0].status+") : "+arguments[0].statusText||arguments[0].responseText,t):o.render("Error",e.ov.json.stringify(arguments,e.ov.json.stringify.COMPACT),t)}}}var c=e.Deferred(),l={command:t,source:i,target:r,view:a,ui:o};n.trigger("ampere.transition",[c,t,i,r,a]),o&&o.block();var p;if(t)try{p=t.call(t,i,r)}catch(m){p=e.Deferred(),p.reject(m)}p&&e.isFunction(p.promise)&&"pending"==p.promise().state()&&o&&o.render("Action",p);var d=this;return e.when(p,s).done(function(){var t=e.extend({},n.current());n.current(r,a);var i=o&&o.getTemplate(a);i.done(function(s){if(n.options("ampere.history.html5")&&o){var u=r.options();if(Object.hasOwnProperty.call(u,"ampere.history.html5.title")){var l=u["ampere.history.html5.title"];document.title=e.isFunction(l)?l.call(r):""+l}else document.title=o.getCaption(r)}s instanceof HTMLElement&&(s=e(s)),i=s.jquery?"SCRIPT"==s[0].tagName?s.text().replace("<![CDATA[","").replace("]]>",""):s:i.responseText||s,o&&o.render("State",a,i,p),e.when(p).done(function(){d.trigger("ampere.view-changed",[t.view]),c.resolveWith(n,[t.view]),o&&o.unblock()})}).fail(u)}).fail(u),p},function(t){var n=e(t);t.trigger=function(t){return t=t[jQuery.expando]?t:new e.Event(t.type||t,"object"==typeof t&&t),n.trigger.apply(n,arguments),t},t.on=e.proxy(n.on,n),t.off=e.proxy(n.off,n),t.one=e.proxy(n.one,n),t.destroy=function(n){e.isFunction(n)&&n.call(t)}(t.destroy)}(this)},void 0):new Module(n,i)}function Ampere(i,r){if(!(this instanceof Ampere)){switch(arguments.length){case 0:i="",r={};break;case 1:var a="string"==typeof i;i=a&&i||"",r=a&&{}||r}return n[i]?(n[i].options=Options(angular.extend(n[i].options(),r)),n[i]):n[i]=new Ampere(i,r)}var o=this;this.options=Options(angular.extend({},Ampere.defaults,r)),this.modules={},this.module=function(){var n=e.ov.namespace("ampere.module()").assert(arguments.length,"no arguments given"),i=e.makeArray(arguments),r=i.shift();"string"!=typeof r||i.length||n.assert(!1,"not enough arguments : ",arguments);var a=e.isFunction(r)?r:i.shift();r="string"==typeof r?r:window.ov.ampere.util.functionName(a),n.assert(r&&""!==r,"module name not given (module constructor function seems also anonymous)"),n.assert(!this.modules[r],'module "'+r+'" already exists');var s={};return this.modules[r]=function(i){if(!(this instanceof Module))return new this.modules[r];this._super(),this.options(angular.extend({},this.ampere().options(),s,i));var o=History(this,this.options());this.history=function(){return o};var u=a.call(this,this);n.assert(!e.isEmptyObject(this.states),"cannot instantiate module without any states");var c=t(this.states);c.push(u),e.isFunction(this.promise)&&c.push(this.promise());var l=this;this.promise=e.when.apply(e.when,c).done(function(){var t=function(e,t){return t.getCaption(e.state())},n=function(e,t){return t.getDescription(e.state())};for(var i in l.states){var r=l.states[i];e.isEmptyObject(r.views)&&r.view("main",null).options({"ampere.ui.caption":t,"ampere.ui.description":n})}}).fail(function(){n.error('failed to load module "',l.name(),'" : ',arguments)}).promise},this.modules[r].defaults=function(e){return s=e,o.modules[r]},this.modules[r].prototype=Module(o,r),this.modules[r]}}function Ui(){return this instanceof Ui?(this._super=function(t,n){this.options=Options(angular.extend({},Ampere.defaults.ui,n)),this.controller=t,this._ns=e.ov.namespace(t.module.fullName()+"::UI");var i=this;this.onHotKey=function(t){if(!i.isBlocked()){var n=window.ov.ampere.ui.hotkey.computeMatchingHotkeys(t);if(-1!=e.inArray(t.target.tagName,["TEXTAREA","SELECT","INPUT"]))for(var r in n)if(/del|up|down|return|left|right|home|end/.test(n[r])&&("return"!=n[r]||"INPUT"!=t.target.tagName))return;var a,o,s=i.controller.module,u=function(r,a,o){var s=a||r.options("ampere.ui.hotkey");if(r.enabled()&&s){var u=s.replace(/\+/g,"_").toLowerCase();if(-1!=e.inArray(u,n))return i._ns.debug("hotkey "+s+" matched"),t.preventDefault(),t.stopImmediatePropagation(),t.currentTarget=t.delegateTarget=t.srcElement=t.target=o,i.controller.proceed(r,[t]),!0}},c=e("*[ng-ampere-hotkey]",i.controller.element).get();for(a in c){o=e(c[a]);var l=o.data("ampereHotkey");for(var p in l){var m=p.replace(/\+/g,"_").toLowerCase();if(-1!=e.inArray(m,n)){i._ns.debug("hotkey "+p+" matched"),t.preventDefault(),t.stopImmediatePropagation();var d=l[p];if(d instanceof Transition)t.currentTarget=t.delegateTarget=t.srcElement=t.target=o[0],i.controller.proceed(d,[t]);else{var f=angular.element(o).scope();f.$apply(d)}return}}}c=e('.ampere-transition[data-ampere-hotkey!=""]',i.controller.element).get();for(a in c)if(o=e(c[a]),o.hasClass("ampere-transition")){var g=o.data("ampereTransition");if(g&&u(g,void 0,o.data("ampere-hotkey",i.controller.element),o[0]))return}for(a in s.current().state.transitions)if(u(s.current().state.transitions[a],void 0,e(".ampere-view:first",i.controller.element)[0]))return;for(a in s.transitions)if(u(s.transitions[a],void 0,e(".ampere-module:first",i.controller.element)[0]))return}}},this.init=function(){e(this.controller.element).on("keydown",this.onHotKey)},this.destroy=function(){e(this.controller.element).off("keydown",this.onHotKey)},this.block=function(){},this.unblock=function(){},this.isBlocked=function(){},this.flash=function(){},this.flash.error=function(){},this.flash.progress=function(){},this.modal=function(){},this.getTransitions=function(t){var n=t||e.noop;e.isFunction(n)||(this._ns.assert(e.isPlainObject(t),'argument "filter" expected to be a function or plain object'),n=function(){for(var e in t){var n=t[e],i=this.options(e);return n instanceof RegExp?n.test(i||""):n===i}});var i,r,a,o=[];i=Object.keys(this.controller.module.transitions);for(r in i)a=this.controller.module.transitions[i[r]],n.call(a)&&o.push(a);i=Object.keys(this.controller.module.current().state.transitions);for(r in i)a=this.controller.module.current().state.transitions[i[r]],n.call(a)&&o.push(a);return o},this.regexp=function(e,t){return RegExp(e,t)},this.render=function(t){if(e.isFunction(this["render"+t])){var n=e.makeArray(arguments);return n.shift(),this["render"+t].apply(this,n)}e.ov.namespace("ampere.ui").debug('skip rendering event "'+t+'" for module "'+this.controller.module.fullName()+'" - no matching function "render'+t+'" defined in renderer')},this._get=function(t,n,i){var r;if(e.isFunction(this.options(t))&&(r=this.options(t).call(this,n)),void 0===r&&e.isFunction(n.options)){if(n instanceof Transition){r=n.options(t);var a=n.target();void 0===r&&-1!=e.inArray("target",i)&&a&&a!==n.state()&&(n=a)}n instanceof View&&(r=n.options(t),void 0===r&&-1!=e.inArray("state",i)&&(n=n.state())),n instanceof State&&(r=n.options(t),void 0===r&&-1!=e.inArray("module",i)&&(n=n.module())),n instanceof Module&&(r=n.options(t))}return e.isFunction(r)?r.call(n,n,this):r},this.getHotkey=function(e){var t=this._get("ampere.ui.hotkey",e,["transition","view","target","state"]);return"string"==typeof t?window.ov.ampere.util.ucwords(t):t},this.getCaption=function(e){var t=this._get("ampere.ui.caption",e,["transition","view","target","state"]);return void 0===t&&(e instanceof Transition?t=window.ov.ampere.util.ucwords(e.name()):e instanceof View?t=window.ov.ampere.util.ucwords(e.name()):e instanceof State?t=window.ov.ampere.util.ucwords(e.name()):e instanceof Module?t=window.ov.ampere.util.ucwords(e.name()):"string"==typeof e&&(t=window.ov.ampere.util.ucwords(e))),void 0!==t?t:e
},this.getDescription=function(e){return this._get("ampere.ui.description",e,["transition","view","target","state"])},this.getAbout=function(e){return this._get("ampere.ui.about",e)},this.getIcon=function(e){return this._get("ampere.ui.icon",e,["transition","view","target","state"])},void 0):new Ui}function UiController(t,n,i){if(!(this instanceof UiController))return new UiController(t,n,i);var r=this,a=e.ov.namespace(n.fullName()+"::UiController");this.options=Options(i),this.module=n,this.element=t,this.element.data("ampere.controller",this),n.history().reset(),this.element.addClass("ampere-app");var o=e.Deferred();o.promise(this),e.when(n).done(function(){var t=r.options("ampere.state")||r.module.current().state||n.options("ampere.state");if("string"==typeof t){var i=n.states[t];a.assert(i instanceof State,'configured default state "',t,'" not found in ',n.fullName(),".states"),t=i}else if(!t)for(var s in n.states){t=n.states[s];break}var u=r.options("ampere.view")||r.module.current().view||n.options("ampere.view");if("string"==typeof u){var c=t.views[u];a.assert(c instanceof View,'configured default view "',u,'" not found in ',t.fullName()+".views"),u=c}else if(!u)for(var l in t.views){u=t.views[l];break}r.ui=r.options("ampere.ui")||n.options("ampere.ui"),a.assert(!(r.ui instanceof Ampere.ui),"controller.options( 'ui') expected to be a ampere ui constructor function but is an object ",r.ui),r.ui=new r.ui(r,angular.extend({},n.options(),r.options())),n.current(t,u),e.when(r.ui.render("Bootstrap")).done(function(){var t=e.noop;if(n.options("ampere.history.html5")&&r.element[0]===document.body){var i=n.options("ampere.history.html5.deeplinking");e.isFunction(i)&&(t=i.call(r))}e.when(t).fail(function(e){r.ui.flash.error("Resolving deep link failed - "+e,!0)}).always(function(){o.resolveWith(r,[n]),n.history().reset()})}).fail(function(){o.rejectWith(r,arguments)})}),this.proceed=function(t,i){var a,o=e.Deferred();if(t.enabled()&&(a=t.target())){n.one("ampere.transition",function(e,t){t.done(o.resolve).fail(o.reject)});var s=t.action();if(s===this.module.history().undo||s===this.module.history().redo)s.call(this.module.history());else if(s===this.module.history().reset)s.call(this.module.history()),this.ui.render("State");else if(s===this.module.current.reset)this.module.current.reset(),this.ui.render("State",this.module.current().view);else{var u=s.call(t,t,this.ui,i);if(u!==!0&&u){var c=!e.isFunction(u)||u&&e.isFunction(u.promise)?u:e.Deferred(function(){this.resolve(u)}),l=arguments,p=this;c.done(function(i){if(0===arguments.length||i){0!==arguments.length&&e.isFunction(i)||(i=u);var o=t.options("ampere.state.view")||a.options("ampere.state.view");if("string"==typeof o){var s=a.views[o];o=s}else if(!o)for(var c in a.views){o=a.views[c];break}r.module.history().redo({command:i,source:t.state()||n.current().state,target:t.target(),view:o,ui:r.ui})}}).fail(function(){if(!arguments.length)return p.ui.render("State"),void 0;var t=function(){return p.proceed.apply(p,l)};if(1==arguments.length&&"string"==typeof arguments[0])r.ui.render("Error",arguments[0],t);else{if(1==arguments.length&&arguments[0]instanceof Error)throw r.ui.render("Error",arguments[0],t),arguments[0];if(3==arguments.length&&e.isFunction(arguments[0].statusCode))throw r.ui.render("Error","Ajax request failed ("+arguments[0].status+") : "+arguments[0].statusText||arguments[0].responseText,t),arguments[0].responseText;r.ui.render("Error",e.ov.json.stringify(arguments,e.ov.json.stringify.COMPACT),t)}})}else u!==!1&&this.ui.render("State",u===!0&&this.module.current().view)}}else o.fail();return o},this.destroy=function(){this.element.removeClass("ampere-app"),this.ui.destroy()},this.getView=function(){var t=this.module.current().state.options("ampere.state.view")||this.module.options("ampere.state.view");if(e.isFunction(t)&&(t=t.call(t,this.module.current().state)),this.module.current().state.views[t])return this.module.current().state.views[t];var n=Object.keys(this.module.current().state.views);return 1==n.length?this.module.current().state.views[n[0]]:this.module.current().state.views.main?this.module.current().state.views.main:this.module.current().state.views[n[0]]}}function Component(t){return this instanceof Component?(this.init=function(){e.ov.namespace(this.fullName()).warn("component did not override init function ",this)},this.name=function(){return t},this.fullName=function(){return"Ampere.Component::"+this.name()},this):new Component(t)}var n={};Ampere.defaults={"ampere.state":"main","ampere.state.view":"main","ampere.ui.options":{},"ampere.history.limit":Number.MAX_VALUE,"ampere.history.html5":!1,"ampere.history.html5.deeplinking":function(){var t=document.location.hash,n=this.module;if(t){t=t.substr(1);for(var i,r=Object.keys(n.states),a=0;r.length>a;a++){var o=n.states[r[a]],s=o.options("ampere.history.html5.route")||e.noop;if(i=s.call(o,t))break}var u=this,c=e.Deferred();return i&&e.isFunction(i)?c=i.call(u):c.reject("no matching deeplink route found."),e.when(c).done(function(){u.ui.update()})}},"ampere.baseurl":function(){for(var e=document.getElementsByTagName("script"),t=0;e.length>t;t++){var n=e[t].src;if(/oval.js/.test(n)){var i=n.match(/(.+)oval\.js(\?(.+))?/);if(i)return i[1]}}return document.location.href}()},Ampere.type=function(t){return t instanceof Ampere?"ampere":t instanceof Module?"module":t instanceof State?"state":t instanceof Transition?"transition":t instanceof View?"view":e.type(t)},Ampere.ui=Ui,Ampere.Component=Component,window.ov=window.ov||{},window.ov.ampere=Ampere,e.fn.ampere=function(t,n){return arguments.length?(n=n||{},e.isFunction(t)&&("ampere.history.html5"in n||(n["ampere.history.html5"]="BODY"==this[0].tagName&&window.top===window.self),t=new t(n)),e.ov.namespace("jQuery.fn.ampere()").assert(t instanceof Module,"argument expected to be a ampere module").assert(1==this.length,"context expected to reference a single dom element but was ",this.get()),UiController(this,t,n)):this.data("ampere.controller")}}(jQuery),window.ov&&window.ov.ampere&&window.ov.ampere.util||function(e){window.ov.ampere.util={ucwords:function(e){return"string"==typeof e||(e=""+e),e?e.replace(/^(.)|\s(.)/g,function(e){return e.toUpperCase()}):e},trueFn:function(){return!0},functionName:function(e){return void 0!==e.name?e.name:(""+e).match(/^function ([^(]+)/)[1]},strip_tags:function(e,t){t=(((t||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");var n=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,i=/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi;return e.replace(i,"").replace(n,function(e,n){return t.indexOf("<"+n.toLowerCase()+">")>-1?e:""})},regexp_quote:function(e){return e.replace(/[\-\/\\\^$*+?.()|\[\]{}]/g,"\\$&")},getTemplate:function(t){t instanceof HTMLElement&&(t=e(t));var n;if(t&&t.jquery)if(e.ov.namespace("window.ov.ampere.util.getTemplate()").assert(t.length,"jQuery collection is empty"),"SCRIPT"==t[0].tagName){n=t.text().replace("<![CDATA[","").replace("]]>","");var i=window.ov.ampere.util.getTemplate[t.attr("type")];e.isFunction(i)&&(n=i(n))}else n=t.html();else n=t&&(t.responseText||""+t)||t;return e.trim(n)},angular:{getElement:function(t){return e("[ng-scope]").filter(function(){return e(this).data("$scope")===t})}},parseParams:function(){var t=/([^&=]+)=?([^&]*)/g,n=function(e){return decodeURIComponent(e.replace(/\+/g," "))};return function(i){var r,a={};if(i)for("?"==i.substr(0,1)&&(i=i.substr(1));r=t.exec(i);){var o=n(r[1]),s=n(r[2]);void 0!==a[o]?(e.isArray(a[o])||(a[o]=[a[o]]),a[o].push(s)):a[o]=s}return a}}()}}(jQuery),window.ov&&window.ov.ampere&&window.ov.ampere.crud||function(e){function Options(t){var n=t||{};return function(){if(2==arguments.length)return n[arguments[0]]=arguments[1],this;if(1==arguments.length){var t=arguments[0];return e.isPlainObject(t)?(angular.extend(n,t),this):n[t]}return n}}function t(t,n){var i=t.options("template");return i||""===i?e.isFunction(i)&&(i=i.call(t,t)):"string"==typeof i?document.getElementById(i)?(i=e(document.getElementById(i)),i&&(i=window.ov.ampere.util.getTemplate(i))):i=e.get(i):i||(i=n,document.getElementById(i)?(i=e(document.getElementById(i)),i&&(i=window.ov.ampere.util.getTemplate(i))):i=e.get(window.ov.ampere.defaults["ampere.baseurl"]+i)),e.isFunction(i.promise)&&(i.promise().done(function(t){t instanceof HTMLElement&&(t=e(t)),i=t.jquery?"SCRIPT"==t[0].tagName?t.text().replace("<![CDATA[","").replace("]]>",""):t:i.responseText||t}),t.promise=i.promise),function(){return i}}window.ov=window.ov||{},window.ov.ampere=window.ov.ampere||{};var n=e.ov.namespace("window.ov.ampere.crud");window.ov.ampere.crud=function(){},window.ov.ampere.crud.list=function i(n,r,a){if(this instanceof i){var o=e.ov.namespace(this.name()),s=function(t){return"string"==typeof t?{get:function(e){return e[t]},template:{append:"{{column.get( item)}}"}}:t instanceof HTMLElement||t.jquery?{template:{append:window.ov.ampere.util.getTemplate(t)}}:e.isPlainObject(t)?e.extend({},t,{get:e.isFunction(t.get)&&t.get||function(e){return e[t.get]},template:function(t){if(t){e.isPlainObject(t)||(t={append:t});for(var n in t)t[n]=e.isFunction(t[n])?t[n]:window.ov.ampere.util.getTemplate(t[n]);return t}return{append:"{{column.get( item)}}"}}(t.template)}):e.isFunction(t)?{get:t,template:{prepend:"{{column.get( item)}}"}}:(o.raise("don't know how to handle column data (=",t,")"),void 0)},u=function(t){if("string"==typeof t||t instanceof HTMLElement||t.jquery)return{template:{prepend:window.ov.ampere.util.getTemplate(t)}};if(e.isPlainObject(t)){var n={template:function(t){if(t){e.isPlainObject(t)||(t={prepend:t});for(var n in t)t[n]=window.ov.ampere.util.getTemplate(t[n]);return t}return{prepend:"{{column.get( item)}}"}}(t.template)};return t.orderBy&&(n.orderBy=e.isFunction(t.orderBy)&&t.orderBy||"string"==typeof t.orderBy&&function(e){return e[t.orderBy]}||e.noop),n}o.raise("don't know how to handle column data (=",t,")")};return o.assert(e.isFunction(n)||e.isArray(n),"first argument expected to be an array or <array>function() but is of type ",e.type(n)),this.columns=function(){if(e.isArray(r)){o.assert(r.length,"argument columns : array cannot be empty");for(var t=0;r.length>t;t++)r[t]=s(r[t])}else r=[s(r||{get:function(e){return e}})];return function(){return r}}(),this.get=function(){return e.isFunction(n)?n.call(this,this):n},this.headers=function(t){var n=[];return function(i){if(arguments.length){if(e.isArray(i))for(var r=0;i.length>r;r++)i[r]=u(i[r]);else i=[u(i)];return o.assert(i.length==t.columns().length,"count of headers(=",i.length,") !== count of columns(=",t.columns().length,")"),n=i,t}return n}}(this),this.sortable=function(e){var t={orderBy:!1,reverse:!0,delegated:!1};return function(n,i,r){return arguments.length?(t.orderBy=n||!1,arguments.length>1&&(t.reverse=i),arguments.length>2&&(t.delegated=r),e):t}}(this),this.draggable=function(t){var n;return function(i){return arguments.length?(n=(e.isPlainObject(i)||e.isFunction(i))&&i||i&&{}||void 0,t):n}}(this),this.editable=function(t){var n;return function(i){return arguments.length?(o.assert(e.isPlainObject(i),"editable( options) : plain object expected as argument but was (",i,")"),o.assert(i.template,"editable( options) : options.template expected but not given (",i.template,")"),n=i,t):n}}(this),this.addable=function(t){var n;return function(i){return arguments.length?(o.assert(e.isPlainObject(i),"addable( options) : plain object expected as argument but was (",i,")"),o.assert(i.template,"addable( options) : options.template expected but not given (",i.template,")"),n=i,t):n}}(this),this.removable=function(t){var n;return function(i){return arguments.length?(n=e.isPlainObject(i)&&i||i&&{}||void 0,t):n}}(this),this.splice=function(t){var n=Array.prototype.splice;return function(i){return arguments.length?(o.assert(e.isFunction(i),"argument expected to be a array like splice function"),n=i,t):n}}(this),this.filter=function(){var t=function(){return!0};return function(){return arguments.length&&e.isFunction(arguments[0])&&(t=arguments[0]),arguments.length?this:t}}(),this.selectable=function(){var t=window.ov.ampere.util.trueFn;return function(){return arguments.length&&(t=e.isFunction(arguments[0])&&arguments[0]||arguments[0]&&window.ov.ampere.util.trueFn||e.noop),arguments.length?this:t}}(),this.selection=function(t){var n=function(){return arguments.length&&t.selectable()(arguments[0])?(n.value=arguments[0],this):-1!=e.inArray(n.value,t.get())?n.value:void 0};return n.value=void 0,n}(this),this.options=Options(e.extend({},window.ov.ampere.crud.list.DEFAULTS,a||{})),this.template=t(this,"ampere-crud-list.default.tmpl"),this.getEditingContext=function(){return this.addable()&&void 0!==this.addable().item&&this.addable()||this.editable()&&void 0!==this.editable().item&&this.editable()},this.init=function(t){o.assert("state"==window.ov.ampere.type(t),'expected to be attached to a state but was attached to a "',window.ov.ampere.type(t),'"'),this.state=function(){return t};var n=Object.keys(t);for(var i in n)if(t[n[i]]===this)break;var r=n[i],a=this.name();this.name=function(){return a+"("+t.name()+"."+r+")"},this.transitions={};var s=this;if(this.draggable()){var u=this.draggable();e.isFunction(u)&&(u={callback:u},this.draggable(u)),u.transition||(s.transitions.move=u.transition=t.transition(t.name()+"."+r+".list_move").action(function(t,n,i){var r=i[0],a=r.data.items[0],o=r.data.position;o-=s.addable()&&s.addable().index&&void 0!==s.addable().item?0:1;var u=e(a).data("position");return r.data.oldPosition=u,r.data.newPosition=o,o!=u?(s.editable()&&delete s.editable().item,s.addable()&&delete s.addable().item,function c(){function n(){s.splice().call(s.get(),o,1),s.splice().call(s.get(),u,0,i);var n=t.options("undo.message");return e.isFunction(n)&&(n=n.call(s)),e.Deferred().resolve(n).promise(c)}var i=s.splice().call(s.get(),u,1)[0];s.splice().call(s.get(),o,0,i);var r=t.options("redo.message");return e.isFunction(r)&&(r=r.call(s)),e.Deferred().resolve(r).promise(n)}):void 0}).options({"undo.message":"Item move undoed.","redo.message":"Item moved.","ampere.ui.description":"Drag to reorder items"}).enabled(function(){return!s.sortable().orderBy&&!s.getEditingContext()}),e.isFunction(u.callback)&&u.callback.call(this,u))}var c;if(this.editable()){var l=this.editable();e.isFunction(l.template)||(c=l.template,l.template=function(){return window.ov.ampere.util.getTemplate(c)}),l.transition||(s.transitions.edit=l.transition=t.transition(t.name()+"."+r+".list_editable").enabled(function(){return void 0!==s.selection()&&void 0===l.item}).action(function(){var e=s.selection();return s.addable()&&delete s.addable().item,s.editable().item=angular.copy(e),function t(){return s.selection(e),function(){return s.selection(e),t}}}).active(function(){return void 0!==s.editable().item}).options({"ampere.ui.description":"Edit item","ampere.ui.icon":"icon-pencil","ampere.ui.caption":null,"ampere.ui.hotkey":"F2"})),l.cancel||(l.cancel=t.transition(t.name()+"."+r+".list_cancel_editable").enabled(function(){return void 0!==s.editable().item}).action(function(){var e=s.selection();return delete s.editable().item,function t(){return s.selection(e),function(){return s.selection(e),t}}}).options({"ampere.ui.description":"Cancel editing","ampere.ui.caption":"Cancel","ampere.ui.hotkey":"Esc"})),l.commit||(l.commit=t.transition(t.name()+"."+r+".list_commit_editable").enabled(function(){return void 0!==l.item}).action(function(t){var n=l.item,i=s.selection(),r=e.inArray(i,s.get());return delete l.item,angular.equals(n,i)?!0:function a(){function o(){s.splice().call(s.get(),r,1,i),s.selection(i);var n=t.options("undo.message");return e.isFunction(n)&&(n=n.call(s)),e.Deferred().resolve(n).promise(a)}s.splice().call(s.get(),r,1,n),s.selection(n);var u=t.options("redo.message");return e.isFunction(u)&&(u=u.call(s)),e.Deferred().resolve(u).promise(o)}}).options({"undo.message":"Item update undoed.","redo.message":"Item updated.","ampere.ui.description":"Apply changes","ampere.ui.caption":"Apply","ampere.ui.hotkey":"Shift+Alt+S"})),e.isFunction(l.callback)&&l.callback.call(this,l)}if(this.addable()){var p=this.addable();e.isFunction(p.template)||(c=p.template,p.template=function(){return window.ov.ampere.util.getTemplate(c)}),p.transition||(s.transitions.add=p.transition=t.transition(t.name()+"."+r+".list_addable").enabled(function(){return void 0===p.item}).action(function(){var e=s.selection();return s.editable()&&delete s.editable().item,p.item={},p.index=s.get().length,function t(){return s.selection(e),function(){return s.selection(e),t}}}).active(function(){return void 0!==s.addable().item}).options({"ampere.ui.description":"Add item","ampere.ui.caption":"Add new item","ampere.ui.hotkey":"Shift+Alt+N"})),p.cancel||(p.cancel=t.transition(t.name()+"."+r+".list_cancel_addable").enabled(function(){return void 0!==p.item}).action(function(){var e=s.selection();return delete p.item,function t(){return s.selection(e),function(){return s.selection(e),t}}}).options({"ampere.ui.description":"Cancel adding item","ampere.ui.caption":"Cancel","ampere.ui.hotkey":"Esc"})),p.commit||(p.commit=t.transition(t.name()+"."+r+".list_commit_addable").enabled(function(){return void 0!==p.item}).action(function(t){var n=p.item,i=p.index&&p.index||0,r=s.selection();return delete p.item,function a(){function o(){s.splice().call(s.get(),i,1),s.selection(r);var n=t.options("undo.message");return e.isFunction(n)&&(n=n.call(s)),e.Deferred().resolve(n).promise(a)}s.splice().call(s.get(),i,0,n),s.selection(n);var u=t.options("redo.message");return e.isFunction(u)&&(u=u.call(s)),e.Deferred().resolve(t.options("redo.message")).promise(o)}}).options({"undo.message":"Item add undoed.","redo.message":"Item added.","ampere.ui.description":"Add item","ampere.ui.caption":"Add","ampere.ui.hotkey":"Shift+Alt+S"})),e.isFunction(p.callback)&&p.callback.call(this,p)}if(this.removable()){var m=this.removable(),d=m.callback;!m.transition||e.isFunction(m.transition)?s.transitions.remove=m.transition=t.transition(t.name()+"."+r+".list_remove").enabled(function(){return!(s.addable()&&void 0!==s.addable().item||s.editable()&&void 0!==s.editable().item||void 0===s.selection())}).action(function(t){var n=m.transition.options("confirm.message");if(e.isFunction(n)&&(n=n.call(this)),!n||window.confirm(n)){var i=s.selection(),r=e.inArray(i,s.get());return function a(){function n(){s.splice().call(s.get(),r,0,i);var n=t.options("undo.message");return e.isFunction(n)&&(n=n.call(s)),e.Deferred().resolve(n).promise(a)}s.splice().call(s.get(),r,1);var o=t.options("redo.message");return e.isFunction(o)&&(o=o.call(s)),e.Deferred().resolve(o).promise(n)}}}).options({"confirm.message":"Really want to remove item ?","undo.message":"Item remove undoed.","redo.message":"Item removed.","ampere.ui.description":"Remove item","ampere.ui.icon":"icon-trash","ampere.ui.caption":null,"ampere.ui.hotkey":"Del"}):o.raise("removable() : dont know how to handle transition argument ",m.transition),e.isFunction(d)&&d.call(m,m)}var f=function(){var t=s.options("list-select-as-transition");return e.isFunction(t)&&t.call(s)||t};this.selectable()&&(this.selectable(),s.transitions.select=t.transition(t.name()+"."+r+".list_select").enabled(function(){return!s.getEditingContext()}).action(function(t,n,i){var r=s.selection(),a=i[0]&&e(i[0].currentTarget).data("position"),o=e.isNumeric(a)&&s.get().length>a&&s.get()[a]||2==i.length&&i[1];if(r!==o||!i[0]){var u=function(){return s.selection(o),function(){return s.selection(r),u}};return f()?u:u()&&void 0}}).options({"ampere.ui.description":"Select item by mousedown","ampere.ui.caption":""}),t.transition(t.name()+"."+r+".list_down").enabled(function(){return!(s.addable()&&s.addable().item||s.editable()&&s.editable().item)}).action(function(t,n){var i=s.selection(),r=window.ov.entity.next(s.rows,s.selection())||s.selection();if(i!==r){var a=function(){return s.selection(r),n.scrollIntoView(e("TR.active:first").next(),!0),function(){return s.selection(i),n.scrollIntoView(e("TR.active:first").prev()),a}};return f()?a:a()&&void 0}}).options({"ampere.ui.description":"Next item","ampere.ui.icon":"icon-down","ampere.ui.caption":"Next","ampere.ui.hotkey":"down"}),t.transition(t.name()+"."+r+".list_up").enabled(function(){return!(s.addable()&&s.addable().item||s.editable()&&s.editable().item)}).action(function(t,n){var i=s.selection(),r=window.ov.entity.prev(s.rows,s.selection())||s.selection();if(i!==r){var a=function(){return s.selection(r),n.scrollIntoView(e("TR.active:first").prev()),function(){return s.selection(i),n.scrollIntoView(e("TR.active:first").next(),!0),a}};return f()?a:a()&&void 0}}).options({"ampere.ui.description":"Previous item","ampere.ui.icon":"icon-down","ampere.ui.caption":"Previous","ampere.ui.hotkey":"up"}),t.transition(t.name()+"."+r+".list_home").enabled(function(){return!(s.addable()&&s.addable().item||s.editable()&&s.editable().item)}).action(function(t,n){var i=s.selection(),r=window.ov.entity.first(s.rows,s.selection())||s.selection();if(i!==r){var a=function(){return s.selection(r),n.scrollIntoView(e("TR.item:first")),function(){return s.selection(i),n.scrollIntoView(e("TR.active:first"),!0),a}};return f()?a:a()&&void 0}}).options({"ampere.ui.description":"First item","ampere.ui.caption":"Home","ampere.ui.hotkey":"home"}),t.transition(t.name()+"."+r+".list_end").enabled(function(){return!(s.addable()&&s.addable().item||s.editable()&&s.editable().item)}).action(function(t,n){var i=s.selection(),r=window.ov.entity.last(s.rows,s.selection())||s.selection();if(i!==r){var a=function(){return s.selection(r),n.scrollIntoView(e("TR.item:last")),function(){return s.selection(i),n.scrollIntoView(e("TR.active:first")),a}};return f()?a:a()&&void 0}}).options({"ampere.ui.description":"Last item","ampere.ui.caption":"End","ampere.ui.hotkey":"end"}))},this}return new i(n,r,a)},window.ov.ampere.crud.list.prototype=new window.ov.ampere.Component("window.ov.ampere.crud.list"),window.ov.ampere.crud.list.DEFAULTS={"list-empty.message":"List is empty.","list-nomatches.message":"No item matches filter.","list-item-dblclick":function(){return this.editable()&&this.editable().transition||!1},"list-select-as-transition":!1},window.ov.ampere.crud.list.angular=function(t){t.directive("ngAmpereCrudList",["$compile","$parse","$window",function(t){return{restrict:"A",scope:"isolate",link:function(n,i,r){n.$watch(r.ngAmpereCrudList,function(r,a){if(a){n.list=a;var o=a.template(),s=e(o);if(s.addClass(i.attr("class")),s.attr("style",i.attr("style")),a.draggable()){var u=a.draggable().handle?", handle : '"+a.draggable().handle+"'":"";s.addClass("table-hover").find("TBODY").attr("ng-ampere-sortable","{ items : 'TR.item'"+u+", transition : list.draggable().transition}"),a.draggable().handle&&s.find("TR.item >TD").addClass("ng-ampere-sortable-nohandle"),s.find("TBODY "+(u?a.draggable().handle:"TR.item")).attr("title",a.draggable().transition.options("ampere.ui.description"))}o=s[0].outerHTML;var c=t(o),l=c(n);i.replaceWith(l),a.element=l}})}}}])},window.ov.ampere.defaults["ampere.ui.angular"]=window.ov.ampere.defaults["ampere.ui.angular"]||[],window.ov.ampere.defaults["ampere.ui.angular"].push(window.ov.ampere.crud.list.angular),window.ov.ampere.crud.paginator=function r(i,a){if(!(this instanceof r))return new r(i,a);n.assert(e.isFunction(i)||e.isArray(i),"first argument expected to be an array or <array>function() but is of type ",e.type(i)),this.get=function(){return e.isFunction(i)?i.call(this,this):i},this.options=Options(e.extend({},window.ov.ampere.crud.paginator.DEFAULTS,a||{})),this.template=t(this,"ampere-crud-paginator.default.tmpl"),this.getPageCount=function(){if(1/0===this.getItemCountPerPage()||1>this.getItemCountPerPage())return 1;var e=this.getPageItems().length;return Math.max(Math.ceil(e/this.getItemCountPerPage()),1)},this.getItemCountPerPage=function(){return this.options("itemCountPerPage")},this._currentPageNumber=1,this.currentPageNumber=function(e){return arguments.length?(n.assert(this.getPageCount()>=e,"currentPageNumber(="+e+") must be less than pageCount(="+this.getPageCount()+")"),this._currentPageNumber=e,this):this._currentPageNumber},this.filter=function(){var t=e.noop;return function(){return arguments.length&&e.isFunction(arguments[0])&&(t=arguments[0]),arguments.length?this:t}}(),this.getPageItems=function(){var t=this.filter();if(t===e.noop)return this.get();for(var n=this.get().slice(0),i=n.length;i--;)t.call(this,n[i])||n.splice(i,1);var r=1/0===this.getItemCountPerPage()||1>this.getItemCountPerPage()?1:Math.ceil(n.length/this.getItemCountPerPage());return this._currentPageNumber>r&&(this._currentPageNumber=r||1),n},this.getCurrentPageItems=e.proxy(function(){var e=this.getPageItems();if(1/0===this.getItemCountPerPage()||1>this.getItemCountPerPage())return e;var t=this.getItemCountPerPage()*(this._currentPageNumber-1);return e.slice(t,Math.min(t+this.getItemCountPerPage(),e.length))},this),this.getPageRange=function(){var e=this.getPageCount(),t=Math.min(this.options("pageRange")-1,e),n=this.currentPageNumber(),i=Math.floor(t/2),r=Math.max(n-i,1),a=Math.min(r+t,e);t>a-r&&(r=t>=e?1:e-t);for(var o=[],s=r;a>=s;s++)o.push(s);return o};var o=function(){var t=e.noop;return function(e){return arguments.length?(t=e,this):t}};this.gotoFirstPage=o(),this.gotoPrevPageRange=o(),this.gotoPrevPage=o(),this.gotoPage=o(),this.gotoNextPage=o(),this.gotoNextPageRange=o(),this.gotoLastPage=o(),this.enabled=function(){var t=e.noop;return function(e){return arguments.length?(t=e,this):t}}(),this.init=function(t){n.assert("state"==window.ov.ampere.type(t),'expected to be attached to a state but was attached to a "',window.ov.ampere.type(t),'"'),this.state=function(){return t};var i=Object.keys(t);for(var r in i)if(t[i[r]]===this)break;var a=i[r],o=this.name();this.name=function(){return o+"("+t.name()+"."+a+")"};var s=this;this.gotoFirstPage(function(e){var n=t.transition(t.name()+"."+a+".firstpage").action(function(){s.currentPageNumber(1)}).enabled(function(){var e=s.enabled().call(s,n);return(void 0===e||e)&&s.currentPageNumber()>1}).options({"ampere.ui.caption":s.options("firstpage.caption"),"ampere.ui.description":s.options("firstpage.description"),"ampere.ui.icon":s.options("firstpage.icon")});return e.call(s,n),n}(this.gotoFirstPage())),this.gotoPrevPageRange(function(e){var n=t.transition(t.name()+"."+a+".prevpagerange").action(function(){s.currentPageNumber(Math.max(s.currentPageNumber()-s.options("pageRange"),1))}).enabled(function(){var e=s.enabled().call(s,n);return(void 0===e||e)&&s.currentPageNumber()>1}).options({"ampere.ui.caption":s.options("prevpagerange.caption"),"ampere.ui.description":s.options("prevpagerange.description"),"ampere.ui.icon":s.options("prevpagerange.icon")});return e.call(s,n),n}(this.gotoPrevPageRange())),this.gotoPrevPage(function(e){var n=t.transition(t.name()+"."+a+".prevpage").action(function(){s.currentPageNumber(s.currentPageNumber()-1)}).enabled(function(){var e=s.enabled().call(s,n);return(void 0===e||e)&&s.currentPageNumber()>1}).options({"ampere.ui.caption":s.options("prevpage.caption"),"ampere.ui.description":s.options("prevpage.description"),"ampere.ui.icon":s.options("prevpage.icon")});return e.call(s,n),n}(this.gotoPrevPage())),this.gotoPage(function(n){var i=t.transition(t.name()+"."+a+".page").action(function(t,n,i){var r=i[0],a=e(r.target).data("page");s.currentPageNumber(a)}).enabled(function(){var e=s.enabled().call(s,i);return void 0===e||e}).options({"ampere.ui.caption":s.options("page.caption"),"ampere.ui.description":s.options("page.description"),"ampere.ui.icon":s.options("page.icon")});return n.call(s,i),i}(this.gotoPage())),this.gotoNextPage(function(e){var n=t.transition(t.name()+"."+a+".nextpage").action(function(){s.currentPageNumber(s.currentPageNumber()+1)}).enabled(function(){var e=s.enabled().call(s,n);return(void 0===e||e)&&s.currentPageNumber()<s.getPageCount()}).options({"ampere.ui.caption":s.options("nextpage.caption"),"ampere.ui.description":s.options("nextpage.description"),"ampere.ui.icon":s.options("nextpage.icon")});return e.call(s,n),n}(this.gotoNextPage())),this.gotoNextPageRange(function(e){var n=t.transition(t.name()+"."+a+".nextpagerange").action(function(){s.currentPageNumber(Math.min(s.currentPageNumber()+s.options("pageRange"),s.getPageCount()))}).options({"ampere.ui.caption":s.options("nextpagerange.caption"),"ampere.ui.description":s.options("nextpagerange.description"),"ampere.ui.icon":s.options("nextpagerange.icon")}).enabled(function(){var e=s.enabled().call(s,n);return(void 0===e||e)&&s.currentPageNumber()<s.getPageCount()});return e.call(s,n),n}(this.gotoNextPageRange())),this.gotoLastPage(function(e){var n=t.transition(t.name()+"."+a+".lastpage").action(function(){s.currentPageNumber(s.getPageCount())}).options({"ampere.ui.caption":s.options("lastpage.caption"),"ampere.ui.description":s.options("lastpage.description"),"ampere.ui.icon":s.options("lastpage.icon")}).enabled(function(){var e=s.enabled().call(s,n);return(void 0===e||e)&&s.currentPageNumber()<s.getPageCount()});return e.call(s,n),n}(this.gotoLastPage()))}},window.ov.ampere.crud.paginator.prototype=new window.ov.ampere.Component("window.ov.ampere.crud.paginator"),window.ov.ampere.crud.paginator.DEFAULTS={itemCountPerPage:10,pageRange:10,"firstpage.caption":"First","firstpage.description":"Goto first page","firstpage.icon":null,"prevpagerange.caption":null,"prevpagerange.description":"Previous page range","prevpagerange.icon":"icon-double-angle-left","prevpage.caption":null,"prevpage.description":"Previous page","prevpage.icon":"icon-angle-left","page.caption":null,"page.description":null,"page.icon":null,"nextpage.caption":null,"nextpage.description":"Next page","nextpage.icon":"icon-angle-right","nextpagerange.caption":null,"nextpagerange.description":"Next page range","nextpagerange.icon":"icon-double-angle-right","lastpage.caption":"Last","lastpage.description":"Last page","lastpage.icon":null},window.ov.ampere.crud.paginator.angular=function(t){t.directive("ngAmpereCrudPaginator",["$compile","$parse","$window",function(t){return{restrict:"A",scope:"isolate",link:function(n,i,r){n.$watch(r.ngAmpereCrudPaginator,function(r,a){if(a){n.paginator=a;var o=a.template(),s=e(o);s.addClass(i.attr("class")),s.attr("style",i.attr("style")),o=s[0].outerHTML;var u=t(o),c=u(n);i.replaceWith(c),a.element=c}})}}}])},window.ov.ampere.defaults["ampere.ui.angular"]=window.ov.ampere.defaults["ampere.ui.angular"]||[],window.ov.ampere.defaults["ampere.ui.angular"].push(window.ov.ampere.crud.paginator.angular)}(jQuery),window.ov&&window.ov.ampere&&window.ov.ampere.ui.twitterbootstrap||function(e){function t(){var t=e(".subnav:last");if(!t.data("inBodyScroll")){if(t.data("inBodyScroll",!0),!t.attr("data-top")){if(t.hasClass("subnav-fixed"))return;var n=t.offset()||{};t.attr("data-top",n.top)}if(e(this).scrollTop()&&t.attr("data-top")-t.outerHeight()<=e(this).scrollTop()){t.addClass("subnav-fixed"),e("body").css("padding-top","");var i=parseInt(e("body").css("padding-top")||0,10);e("body").css("padding-top",i+t.height()+"px")}else t.removeClass("subnav-fixed"),e("body").css("padding-top","");window.setTimeout(function(){t.data("inBodyScroll",!1)},300)}}function n(t){var n=angular.element(this).scope().transition,i=e(this).closest(".ampere-app").ampere();!i.ui.isBlocked()&&i.proceed(n,[t]),t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation()}function i(e){var t=e.find(".ampere-state .ampere-view input,select,textarea,button").filter('[tabIndex!="-1"]:visible:enabled');t.filter("*[autofocus]").focus().length||t.first().focus()}function r(){e.ov.namespace("twitterboostrap::onActionAbort()").debug("action aborted");var t=e(this).closest(".ampere-app").ampere();if(window.confirm("Really abort transition ?")){t.ui.flash();var n=t.ui.flash.getElement().data("ampere.action-deferred");s.assert(n&&e.isFunction(n.promise),"no action deferred registered on flash element"),n.reject(t.module)
}}function a(t){var n=e(this).find('[class^="icon-"]:first');n.length&&t.originalEvent.dataTransfer.setDragImage(n[0],-10,-10),t.originalEvent.dataTransfer.setData("DownloadURL",e(this).data("downloadurl")||"application/octet-stream:"+this.href.replace(/^.*[\/\\]/g,"")+":"+this.href)}function o(u,c){function l(t){if(!e.isEmptyObject(l.handlers))try{var n=t.originalEvent.source.location.href.match(/[^#]+/);l.handlers[n]&&l.handlers[n](t.originalEvent.data,t.originalEvent.source)}catch(i){}}function p(){e(this).trigger("input")}if(!(this instanceof o))return new o(u,c);var m=this;this._super(u,angular.extend({},o.defaults,c||{}));var d=this.options("ampere.ui.angular");if(d){s.assert(e.isArray(d),'option "ampere.ui.angular" expected to be an array but is of type ',e.type(d));for(var f=angular.module("window.ov.ampere.ui.twitterbootstrap"),g=0;d.length>g;g++)s.assert(e.isFunction(d[g]),'items of option "ampere.ui.angular" expected to be an function but is of type ',e.type(d[g])),d[g].call(f,f)}var h="default";Object.hasOwnProperty.call(this.options(),"ampere.ui.layout")&&(h=this.options("ampere.ui.layout"),h||(h="nolayout"));var v;if(-1!=e.inArray(h,["default","nolayout","wizard"])){var w="ampere-ui-twitterbootstrap.layout."+h+".tmpl";v=h,h=document.getElementById(w)?e(document.getElementById(w)):this.options("ampere.baseurl")+"ampere-ui-twitterbootstrap.layout."+h+".tmpl",u.element.addClass("layout-name-"+v)}else"string"==typeof h&&(document.getElementById(h)&&(h=e(document.getElementById(h))),u.element.addClass("layout-name-"+h.replace(/(^.*[\/\\])|\./g,"")));this.layout="string"==typeof h?e.get(h):h;for(v in u.module.transitions){var y=u.module.transitions[v];"ampere.ui.type"in y.options()||y.options("ampere.ui.type","global")}l.handlers={};var b=this.init;this.init=function(){b.call(this),"BODY"==this.controller.element[0].tagName&&e(window).on("resize scroll",t),this.controller.element.on("change",'input[data-provide="typeahead"]',p),this.controller.element.on("click",".ampere-transition:not( .ampere-transition-companion)",n),this.controller.element.on("click",".flash .alert button.close",r),this.controller.element.on("dragstart","a[draggable]",a),e(window).on("message",l),i(u.element)};var k=this.destroy;this.destroy=function(){k.call(this),"BODY"==this.controller.element[0].tagName&&e(window).off("resize scroll",t),this.controller.element.off("change",'input[data-provide="typeahead"]',p),this.controller.element.off("click",".ampere-transition",n),this.controller.element.off("click",".flash .alert button.close",r),e(this.controller.element).off("dragstart","a[draggable]",a),e(window).off("message",l)},this.scrollIntoView=function(e,t){var n=e.parent().closest(".scrollable");n.length&&(t?0>e.position().top?this.scrollIntoView(e):e.position().top>=n.height()&&n.stop().animate({scrollTop:n.scrollTop()+e.position().top-n.height()+e.height()},"fast"):0>e.position().top?n.stop().animate({scrollTop:n.scrollTop()+e.position().top},"fast"):e.position().top>=n.height()&&this.scrollIntoView(e,!0))},this.flash=function(t,n){if(arguments.length){n=n||{};var i=this.flash.getElement();switch(n.type){case"progress":if(i.addClass("wait"),i.find(".alert").removeClass("alert-error").addClass("alert-info"),i.find(".progress").show().find(".bar").css("width",n.value),t&&"progress"===t.type){var r=!!n.value;i.find(".message").text(r?"Uploading ...":"Downloading ...")}else i.find(".message").text(t);var a=n.deferred;i.find("button.close")[a&&e.isFunction(a.reject)?"show":"hide"]();break;case"error":if(i.stop(!0).css("opacity","1"),i.removeClass("wait"),i.find(".alert").removeClass("alert-info").addClass("alert-error"),i.find(".progress").hide(),i.find(".message").text("Error occured : "+t),n.value){var o=e('<button class="btn retry"><i class="'+(e.isFunction(n.value)&&"icon-refresh")+'"></i>'+(e.isFunction(n.value)?"Retry":"Ok")+"</button>");o.click(function(){i.hide(),e.isFunction(n.value)&&n.value()});var s=e('<button class="btn"><i></i>Cancel</button>');s.click(function(){i.hide(),m.unblock()}),i.find(".message").append(e('<div class="btn-group">').append(o,s))}i.find("button.close").hide();break;default:return i.removeClass("wait"),i.find(".alert").removeClass("alert-error alert-info"),i.find(".progress, button.close").hide(),i.find(".message").text(t),i.show().fadeOut(1e3),void 0}i.show()}else this.flash.getElement().hide();return this.flash},this.flash.getElement=function(){return u.element.find(".flash")},this.flash.progress=function(e,t,n){return void 0===e?m.flash():m.flash(e||"Operation in progress ...",{type:"progress",value:t||"100%",deferred:n||m.flash.getElement().data("ampere.action-deferred")})},this.flash.error=function(e,t){return m.flash(e,{type:"error",value:t})},this.isBlocked=function(){return this.controller.element.find(".overlay").hasClass("block")},this.block=function(){return this.controller.element.addClass("overlay").find(".overlay").addClass("block"),this},this.unblock=function(){return this.controller.element.removeClass("overlay").find(".overlay").removeClass("block"),this},this.getTemplate=function(t){var n=t.template();return n||""===n?e.isFunction(n)&&(n=n.call(t,t)):(n=this.options("ampere.ui.view"),"string"==typeof n?n=document.getElementById(n)?e(document.getElementById(n)):e.get(t):n||(n="ampere-ui-twitterbootstrap.view.default.tmpl",n=document.getElementById(n)?e(document.getElementById(n)):e.get(this.options("ampere.baseurl")+n))),e.ov.namespace("ngState").assert(!e.isFunction(n.promise)||"success"!=n.promise().state(),"view fragment is not ready : state=",e.isFunction(n.promise)?n.promise().state():""),e.when(e.isFunction(n.promise)?n.promise():n)},this.renderAction=function(e){this.flash.progress("Transition in progress ...","100%",e).getElement().data("ampere.action-deferred",e),e.progress(m.flash.progress).then(function(){m.flash().getElement().removeData("ampere.action-deferred")})},this.renderError=function(e,t){this.refresh(),this.flash.error(e,t)},this.update=function(){var t,n=angular.element(u.element.find(".ampere-view:first")).scope(),i=e.grep(Object.keys(n),function(e){return"this"!=e&&"$"!=e.charAt(0)}),r=Object.keys(n.$ampere.module.current().state);for(t in r)if(s.assert("this"!=r[t],'state property named "this" is forbidden').assert("$"!=r[t].charAt(0),'state property starting with $ (="',r[t],'") is forbidden'),"promise"!=r[t]){n[r[t]]!==n.$ampere.module.current().state[r[t]]&&(n[r[t]]=n.$ampere.module.current().state[r[t]],s.debug("update scope."+r[t]+"=",e.ov.json.stringify(n[r[t]],e.ov.json.stringify.COMPACT)));var a=e.inArray(r[t],i);-1!=a&&i.splice(a,1)}for(t in i)s.debug("delete previsouly defined scope."+i[t]),delete n[i[t]];return n.$$phase||n.$apply(e.noop),u.module.trigger("ampere.view-updated"),this},this.refresh=function(){return this.renderState(u.module.current().view),u.module.trigger("ampere.view-refreshed"),this},this.renderState=function(t,n,r){e("body").children(".dropdown-menu").remove(),window.scrollX,window.scrollY;var a=angular.element(u.element.find(">.ampere-module")).scope(),o=function(){t&&(e(".modal:visible").hide(),e(".modal-backdrop").remove(),a.$ampere={module:u.module,ui:u.ui,view:t,template:""===n?n:n||a.$ampere.template})};"$apply"==a.$$phase?o():a.$apply(o),e.when(r).done(function(){e("input[data-date-format]").datepicker({autoclose:!0}).on("changeDate",function(t){e(t.target).trigger("input")}),e(".html5validation-title").each(function(){e(this).attr("title",this.validationMessage)}),i(u.element),"string"==typeof arguments[0]?m.flash(arguments[0]):m.flash()})},this.modal=function(t,n){n=n||{};var i,r=e.noop;n.container?(i=e('<div class="modal-embed-backdrop"></div><div class="container modal-embed"><iframe border="no" src="'+t+'"></iframe></div>'),u.element.addClass("modal-embed"),n.container.addClass("modal-embed-container").append(i),t=i.find("iframe")[0].src,r=function(){u.element.removeClass("modal-embed"),n.container.removeClass("modal-embed-container"),i.remove()}):(i=e('<div class="container modal-popup"><iframe width="100%" height="100%" border="no" src="'+t+'"></iframe></div>'),u.element.addClass("modal-popup").find(".ampere-module").append(i),t=i.find("iframe")[0].src,r=function(){u.element.removeClass("modal-popup"),i.remove()}),i.find("iframe").focus();var a=e.Deferred(n.callback||e.noop);return l.handlers[t]=e.proxy(n.onMessage||e.noop,a),a.always(function(){r(),delete l.handlers[t]}),a},this.toggleHelp=function(){u.element.find(".page-header >.ampere-help").toggle("slow")},this.renderBootstrap=function(){var t=this.controller,n=e('<div class="progress progress-striped active"><div class="bar" style="width: 100%;"></div></div>');t.element.append(n).css("cursor","wait");var i=t.element.find(".bar");i.text("Bootstrapping "+t.module.name()+" ...");var r=e.Deferred();return e.when(t.module.current().view,t.module.current().view.template,this.layout,t.module).progress(function(){s.debug("progress",this,arguments)}).always(function(){i.css("width","100%"),t.element.css("cursor","")}).fail(function(n){i.text("Bootstrapping "+t.module.name()+" failed ! ").append(e('<a href="#">Details</a>').one("click",function(){t.element.append('<div class="alert">'+(m.layout.isRejected()?m.layout.statusText+" : "+h:e.ov.json.stringify(n,e.ov.json.stringify.COMPACT))+"</div>")})),e(".progress",t.element).addClass("progress-danger"),r.resolveWith(t.ui,m.layout.isRejected()?m.layout.statusText+" : "+h:n)}).done(function(){n.remove(),t.element.append(m.layout.responseText?m.layout.responseText:m.layout.jquery&&"SCRIPT"==m.layout[0].tagName?m.layout.text().replace("<![CDATA[","").replace("]]>",""):m.layout);var i=m.getTemplate(t.module.current().view);i.done(function(n){n instanceof HTMLElement&&(n=e(n)),i=n.jquery?"SCRIPT"==n[0].tagName?n.text().replace("<![CDATA[","").replace("]]>",""):n:i.responseText||n,t._initial_template=i,angular.bootstrap(t.element.find(">.ampere-module").addClass("name-"+t.module.name()),["window.ov.ampere.ui.twitterbootstrap"]),m.init(),t.module.trigger("ampere.view-changed"),r.resolveWith(t.ui,[])})}),r}}var s=e.ov.namespace("window.ov.ampere.ui.twitterbootstrap");(function(){function t(t){var i="ngAmpere"+window.ov.ampere.util.ucwords(t);n.directive(i,[function(){var n=e.ov.namespace(i);return{restrict:"A",link:function(r,a,o){e(a).on(t,function(e){var a=r.$eval(o[i]);if(a){var s=r.$ampere.ui,u=s.controller;!s.isBlocked()&&u.proceed(a,[e])}else a!==!1&&n.error('attribute "ng-ampere-'+t+'" (='+o[i]+") doesnt resolve to an ampere transition")})}}}])}var n=angular.module("window.ov.ampere.ui.twitterbootstrap",["ngResource","ngCookies"]).run(function(){});n.filter("ucwords",function(){return function(e){return window.ov.ampere.util.ucwords(e)}}),n.filter("strip_tags",function(){return function(e){return"string"==typeof e&&window.ov.ampere.util.strip_tags(e)||e}}),n.filter("replace",function(){return function(e,t,n){var i=t.lastIndexOf("/"),r=RegExp(t.substr(1,i-1),t.substr(i+1));return e.replace(r,n)}}),n.filter("next",function(){return function(e,t){return window.ov.entity.next(e,t)||t}}),n.filter("prev",function(){return function(e,t){return window.ov.entity.prev(e,t)||t}}),n.filter("indexof",function(){return function(t,n){return e.inArray(n,t)}}),n.filter("type",function(){return function(e){return window.ov.ampere.type(e)}}),n.filter("match",function(){return function(t,n,i){return i=void 0!==i||"id",e.isArray(n)||(n=[n]),e.grep(t,function(e){for(var t in n)if(n[t]instanceof RegExp?n[t].test(e[i]):e[i]==n[t])return!0})}}),n.filter("find",function(){return function(t,n,i){i=void 0!==i&&i||"id",e.isArray(n)||(n=[n]);var r;for(var a in n)if(r=window.ov.entity.find(t,n[a],i))return r}}),n.filter("sort",function(){return function(e,t){return window.ov.entity.sort(e,t)}}),n.filter("keys",function(){return function(e){return Object.keys(e)}}),n.config(function(e){e.decorator("$exceptionHandler",function(e){return function(t,n){e(t,n)}})});var i=function(t,n,i,r,a,o,s,u){var c=n.parent().data("ampere.controller"),l=c._initial_template;c._initial_template=void 0,t.$ampere={module:c.module,ui:c.ui,template:l,view:c.module.current().view},t.$window=i,t.$http=r,t.$timeout=a,t.$log=o,t.$resource=s,t.$cookies=u,t.$=e,n.data("ampere.disposable",[])};i.$inject=["$scope","$rootElement","$window","$http","$timeout","$log","$resource","$cookies"],n.controller("amperetwitterbootstrap",i),n.directive("ngAmpereState",["$compile","$window",function(t,n){return{restrict:"A",scope:"isolate",link:function(i,r){i.$watch("$ampere",function(){i.$ampere.scope=i;for(var a=r.closest(".ampere-module").data("ampere.disposable");a.length;)a.pop()();for(;i.$$childHead;)i.$$childHead.$destroy();var o=e.ov.namespace("ngAmpereTransition("+i.$ampere.module.current().state.fullName()+")");o.debug("ampere changed");var s,u=Object.keys(i);for(s in u)"this"!=u[s]&&"$"!=u[s].charAt(0)&&(o.debug("delete previously defined scope."+u[s]),delete i[u[s]]);u=Object.keys(i.$ampere.module.current().state);for(s in u)e.ov.namespace("ngState").assert("this"!=u[s],'state property named "this" is forbidden').assert("$"!=u[s].charAt(0),'state property starting with $ (="',u[s],'") is forbidden'),"promise"!=u[s]&&(i[u[s]]=i.$ampere.module.current().state[u[s]],o.debug("set initial scope."+u[s]+"=",n.$.ov.json.stringify(i[u[s]],n.$.ov.json.stringify.COMPACT)));var c=i.$ampere.template;r.html(c),t(r.contents())(i)}),i.$watch(function(){var t,r=e.ov.namespace("ngAmpereTransition("+i.$ampere.module.current().state.fullName()+")"),a={},o=Object.keys(i);for(t in o)"promise"!=o[t]&&"this"!=o[t]&&"$"!=o[t].charAt(0)&&(a[o[t]]=i[o[t]]);o=Object.keys(a),n.jQuery.each(Object.keys(i.$ampere.module.current().state),function(t,n){-1!=e.inArray(n,o)||o.push(n)});var s=[],u=[];for(t in o){var c=o[t];"promise"!=c&&(Object.hasOwnProperty.call(a,c)?angular.equals(a[c],i.$ampere.module.current().state[c])?delete a[c]:u.push(c):s.push(c))}if(u.length||s.length){for(t in u)i.$ampere.module.current().state[u[t]]=a[u[t]],r.debug(i.$ampere.module.current().state.fullName(),".",u[t],"=",a[u[t]]);for(t in s)delete i.$ampere.module.current().state[s[t]],r.debug("delete ",i.$ampere.module.current().state.fullName(),".",s[t]);r.debug("broadcast ampere-model-changed ( ",a,", ",s,")"),i.$root.$broadcast("ampere-model-changed",a,s)}i.$ampere.module.trigger("ampere.angular-scope-changed",[i])})}}}]),n.directive("ngAmpereTransition",["$compile","$parse","$window",function(t,n,i){var r={a:'<a href="javascript:void(0)" class="ampere-transition name-{{transition.name()}} {{attrs.class}} {{$css()}}" ng-class="{disabled : !transition.enabled(), active : transition.active(), \'ampere-hotkey\' : hotkey}" accesskey="{{attrs.accesskey}}" id="{{attrs.id}}" tabindex="{{attrs.tabindex}}" style="{{attrs.style}}" data-ampere-hotkey="{{attrs.ngAmpereHotkey}}" title="{{attrs.title || $ampere.ui.getDescription( transition) | strip_tags}}{{hotkey && \' \' + hotkey}}"><i ng-class="attrs.ngAmpereIcon || $ampere.ui.getIcon( transition)"></i>{{(attrs.ngAmpereIcon || $ampere.ui.getIcon( transition)) && ($.trim( element.text()) || $ampere.ui.getCaption( transition)) && \'&nbsp;\' || \'\'}}{{$.trim( element.text()) || $ampere.ui.getCaption( transition)}}</a>',button:'<button type="button" ng-disabled="!transition.enabled()" class="ampere-transition name-{{transition.name()}} btn {{attrs.class}} {{$css()}}" ng-class="{disabled : !transition.enabled(), active : transition.active(), \'ampere-hotkey\' : hotkey}" ng-disabled="!transition.enabled()" id="{{attrs.id}}" tabindex="{{attrs.tabindex}}" accesskey="{{attrs.accesskey}}" style="{{attrs.style}}" data-ampere-hotkey="{{attrs.ngAmpereHotkey}}" title="{{attrs.title || $ampere.ui.getDescription( transition) | strip_tags}}{{hotkey && \' \' + hotkey}}"><i ng-class="attrs.ngAmpereIcon || $ampere.ui.getIcon( transition)"></i>{{(attrs.ngAmpereIcon || $ampere.ui.getIcon( transition)) && ($.trim( element.text()) || $ampere.ui.getCaption( transition)) && \'&nbsp;\' || \'\'}}{{$.trim( element.text()) || $ampere.ui.getCaption( transition)}}</button>',file:'<button type="button" onclick="$( this).next().click()" ng-disabled="!transition.enabled()" class="ampere-transition name-{{transition.name()}} btn ampere-transition-companion {{attrs.class}} {{$css()}}" ng-class="{disabled : !transition.enabled(), active : transition.active(), \'ampere-hotkey\' : hotkey}" ng-disabled="!transition.enabled()" accesskey="{{attrs.accesskey}}" tabindex="{{attrs.tabindex}}" style="{{attrs.style}}" data-ampere-hotkey="{{attrs.ngAmpereHotkey}}" title="{{attrs.title || $ampere.ui.getDescription( transition) | strip_tags}}{{hotkey && \' \' + hotkey}}"><i ng-class="attrs.ngAmpereIcon || $ampere.ui.getIcon( transition)"></i>{{(attrs.ngAmpereIcon || $ampere.ui.getIcon( transition)) && ($.trim( element.text()) || $ampere.ui.getCaption( transition)) && \'&nbsp;\' || \'\'}}{{$.trim( element.text()) || $ampere.ui.getCaption( transition)}}</button><input id="{{attrs.id}}" name="{{attrs.name}}" class="ampere-transition-companion" ng-class="{disabled : !transition.enabled()}" type="file" ng-ampere-change="transition">',submit:'<button type="submit" ng-disabled="!transition.enabled()" class="ampere-transition name-{{transition.name()}} btn {{attrs.class}}  {{$css()}}" ng-class="{disabled : !transition.enabled(), active : transition.active(), \'ampere-hotkey\' : hotkey}" ng-disabled="!transition.enabled()" id="{{attrs.id}}" accesskey="{{attrs.accesskey}}" tabindex="{{attrs.tabindex}}" style="{{attrs.style}}" data:ampere-hotkey="{{attrs.ngAmpereHotkey}}" title="{{attrs.title || $ampere.ui.getDescription( transition) | strip_tags}}{{hotkey && \' \' + hotkey}}"><i ng-class="attrs.ngAmpereIcon || $ampere.ui.getIcon( transition)"></i>{{(attrs.ngAmpereIcon || $ampere.ui.getIcon( transition)) && ($.trim( element.text()) || $ampere.ui.getCaption( transition)) && \'&nbsp;\' || \'\'}}{{$.trim( element.text()) || $ampere.ui.getCaption( transition)}}</button>',reset:'<button type="reset" ng-disabled="!transition.enabled()" class="ampere-transition name-{{transition.name()}} btn {{attrs.class}}  {{$css()}}" ng-class="{disabled : !transition.enabled(), active : transition.active(), \'ampere-hotkey\' : hotkey}" ng-disabled="!transition.enabled()" accesskey="{{attrs.accesskey}}" tabindex="{{attrs.tabindex}}" style="{{attrs.style}}" data-ampere-hotkey="{{attrs.ngAmpereHotkey}}" title="{{attrs.title || $ampere.ui.getDescription( transition) | strip_tags}}{{hotkey && \' \' + hotkey}}"><i ng-class="attrs.ngAmpereIcon || $ampere.ui.getIcon( transition)"></i>{{(attrs.ngAmpereIcon || $ampere.ui.getIcon( transition)) && ($.trim( element.text()) || $ampere.ui.getCaption( transition)) && \'&nbsp;\' || \'\'}}{{$.trim( element.text()) || $ampere.ui.getCaption( transition)}}</button>'};r.li='<li class="ampere-transition name-{{transition.name()}}" ng-class="{disabled : !transition.enabled(), active : transition.active()}">'+r.a+"</li>";var a=e.ov.namespace("ngAmpereTransition");return{restrict:"A",scope:"isolate",link:function(n,o,s){n.element=o,n.attrs=s,n.$=i.jQuery,n.$on("ampere-model-changed",function(){n.transition&&(n.$enabled=n.transition.enabled())}),n.$watch(s.ngAmpereTransition,function(i,u){if(!u)return o.replaceWith('<span style="background-color:crimson; color:white">attribute "ng-ampere-transition" (="'+s.ngAmpereTransition+'") does not resolve to a ampere transition'+"</span>"),void 0;a=e.ov.namespace("ngAmpereTransition("+u.fullName()+")");var c=s.type||u.options("ampere-ui-input-type")||(-1!=e.inArray(o[0].tagName.toLowerCase(),Object.keys(r))?o[0].tagName.toLowerCase():"button");if(n.transition=u,n.$enabled=n.transition.enabled(),n.$css=function(t){return function(){return e.isFunction(t)?t.call(this,this):t}}(n.transition.options("ampere.ui.class")),a.assert("transition"==window.ov.ampere.type(n.transition),'attribute "ng-ampere-transition" (="',s.ngAmpereTransition,'") does not resolve to a ampere transition'),r[c]){var l=r[c];(c="file"&&"A"==o[0].tagName)&&(l=l.replace(/\type="button"|btn/g,"").replace(/button/g,"a"));var p=t(l),m=p(n);o.replaceWith(m),m.tabIndex=o.tabInde;for(var d=Object.keys(o[0].dataset),f=0;d.length>f;f++)m.attr("data-"+d[f],o[0].dataset[d[f]]);var g=s.ngAmpereHotkey||n.$ampere.ui.getHotkey(n.transition);g&&(n.hotkey=" ("+window.ov.ampere.util.ucwords(g)+")"),m.data("ampereTransition",u)}else a.raise('type "',c,'" is unknown')})}}}]),t("change"),t("click"),t("dblclick"),t("mousedown"),t("mouseup"),n.directive("ngAmpereDrop",[function(){var t=e.ov.namespace("ngAmpereDrop");return{restrict:"A",link:function(n,i,r){e(i).on("drop",function(e){var i=n.$eval(r.ngAmpereDrop);if(i){var a=n.$ampere.ui,o=a.controller;!a.isBlocked()&&o.proceed(i,[e])}else t.error('attribute "ngAmpereDrop" (='+r.ngAmpereDrop+") doesnt resolve to an ampere transition");return e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),!1}).on("dragover",function(e){e.preventDefault()})}}}]),n.directive("ngAmpereSortable",["$timeout",function(t){var n=e.ov.namespace("ngAmpereSortable");return{restrict:"A",link:function(i,r,a){var o,s={helper:function(t,n){var i=n.children(),r=n.clone();return r.children().each(function(t){e(this).width(i.eq(t).width())}),r},placeholder:"sortable-placeholder",forcePlaceholderSize:!0,stop:function(e,t){var n=i.$ampere.ui,r=n.controller;e.data={items:t.item,position:t.item.index()},"transition"==window.ov.ampere.type(o)?!n.isBlocked()&&r.proceed(o,[e]):o(null,n,[e])}},u=e.extend({},s),c=i.$eval(a.ngAmpereSortable);e.isPlainObject(c)?(o=c["ng-ampere-transition"]||c.transition||o,e.extend(u,c)):c?o=c:n.raise('could not evaluate attribute "ng-ampere-transition" to an object or function (="'+a.ngAmpereSortable+'")'),n.assert("transition"==window.ov.ampere.type(o)||e.isFunction(o),"value option transition or ng-ampere-transition doesnt resolve to a transition"),i.$watch(function(){r.hasClass("ui-sortable")&&(u.handle||e(u.items,r.get()).addClass("draghandle"),e(r.get()).sortable("refresh"))}),t=function(e){e()},t(function(){"string"==typeof u.items?u.items="> "+u.items:u.items||(u.items="> *:not(.ng-ampere-sortable-nohandle)"),u.handle||e(u.items,r.get()).addClass("draghandle"),"transition"==window.ov.ampere.type(o)&&e(r.get()).on("mousedown",u.items,function(e){o.enabled()||e.stopImmediatePropagation()}),e(r.get()).sortable(u)})}}}]),n.directive("ngAmpereHotkey",[function(){var t=e.ov.namespace("ngAmpereHotkey");return{restrict:"A",link:function(n,i,r){if(!r.ngAmpereTransition){var a=n.$eval(r.ngAmpereHotkey);t.assert(e.isPlainObject(a),'attribute "ng-ampere-hotkey"(="'+r.ngAmpereHotkey+'") expected to evaluate to an object'),i.data("ampereHotkey",a)}}}}]),n.directive("ngAmpereData",[function(){var t=e.ov.namespace("ngAmpereData");return{restrict:"A",link:function(n,i,r){var a=n.$eval(r.ngAmpereData);t.assert(e.isPlainObject(a),'attribute "ng-ampere-data"(="'+r.ngAmpereData+'") expected to evaluate to an object'),angular.extend(i.data(),a)}}}]),n.directive("ngAmpereWatch",[function(){var t=e.ov.namespace("ngAmpereWatch");return{restrict:"A",link:function(n,i,r){function a(e,t){return function(n){var r=(1==arguments.length?n:arguments[2]).$ampere.module.current().state,a=[];1==arguments.length?a.push(r):(a.push(r),a.push(t)),a.push(i),e.apply(n,a)}}var o=i.closest(".ampere-module").data("ampere.disposable"),s=n.$eval(r.ngAmpereWatch);if(e.isFunction(s))t.debug("activate watch(*) ",window.ov.ampere.util.functionName(s)||"function","()"),o.push(n.$watch(a(s)));else if(e.isPlainObject(s))for(var u in s){var c=s[u];t.assert(e.isFunction(c),"watcher property value of key '",u,"'(=",e.ov.json.stringify(c,e.ov.json.stringify.COMPACT),") expected to be a function");for(var l=u.split(/\s*,\s*/g),p=0;l.length>p;p++){var m=l[p];""===m||"*"===m?(t.debug("activate watch(*) ",window.ov.ampere.util.functionName(c)||"function","()"),o.push(n.$watch(a(c)))):(t.debug("activate watch(",m,") ",window.ov.ampere.util.functionName(c)||"function","()"),o.push(n.$watch(m,a(c,m))))}}else t.raise('dont know how to handle argument "',r.ngAmpereWatch,'". function or plain object argument is expected.')}}}]),n.directive("ngAmpereDeferred",[function(){var t=e.ov.namespace("ngAmpereDeferred");return{restrict:"A",link:function(n,i,r){function a(t){var n=t.call(i,i);return e.isFunction(n.abort)&&n.abort||e.isFunction(n.reject)&&n.reject||e.noop}var o=i.closest(".ampere-module").data("ampere.disposable"),s=n.$eval(r.ngAmpereDeferred);t.assert(e.isFunction(s),"Argument ngAmpereDeferred(=",i.attr("ng-ampere-deferred"),") expected to be a function<Deferred>"),o.push(a(s))}}}]),n.directive("ngAmpereTemplate",["$compile",function(t){return{restrict:"A",scope:!1,link:function(n,i,r){var a=i.contents();n.$watch(r.ngAmpereTemplate,function(r){if(r){e.isPlainObject(r)||(r={replace:r}),i.empty();var o=window.ov.ampere.util.getTemplate(e.isFunction(r.prepend)&&r.prepend.call(window,window)||r.prepend||"");o&&i.append(o),o=window.ov.ampere.util.getTemplate(e.isFunction(r.replace)&&r.replace.call(window,window)||r.replace||"")||a,o&&i.append(o),o=window.ov.ampere.util.getTemplate(e.isFunction(r.append)&&r.append.call(window,window)||r.append||""),o&&i.append(o),t(i.contents())(n)}},!0)}}}]),n.directive("ngAmpereValidate",[function(){var t=e.ov.namespace("ngAmpereValidate");return{restrict:"A",link:function(n,i,r){var a=n.$eval(r.ngAmpereValidate);t.assert(e.isFunction(a),'dont know how to handle argument "',r.ngAmpereWatch,'". function or plain object argument is expected.');var o=n.$ampere.module.current().state;e.isFunction(a)&&(r.ngModel?n.$watch(r.ngModel,function(){i.setCustomValidity(""),a.call(i.get(),i,o)},!0):i.on("input",function(){i.setCustomValidity(""),a.call(i,i,o)}))}}}])})(),o.prototype=window.ov.ampere.ui(),o.defaults={"ampere.ui.twitterbootstrap.theme":"default"},window.ov.ampere.defaults["ampere.ui"]=window.ov.ampere.ui.twitterbootstrap=o,window.top!==window.self&&e("html").addClass("iframe")}(jQuery),window.ov&&window.ov.ampere&&window.ov.ampere.ui.hotkey||function(e){function t(e){var t="keypress"!==e.type&&n[e.which],r=String.fromCharCode(e.which).toLowerCase(),a="",o=[];return e.altKey&&"alt"!==t&&(a+="alt_"),e.ctrlKey&&"ctrl"!==t&&(a+="ctrl_"),e.metaKey&&!e.ctrlKey&&"meta"!==t&&(a+="meta_"),e.shiftKey&&"shift"!==t&&(a+="shift_"),t?o.push(a+t):(o.push(a+r),o.push(a+i[r]),"shift_"===a&&o.push(i[r])),o}e.ov.namespace("window.ov.ampere.ui.twitterbootstrap");var n={8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",188:",",190:".",191:"/",224:"meta"},i={"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"};window.ov.ampere.ui.hotkey={computeMatchingHotkeys:t}}(jQuery);